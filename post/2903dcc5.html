<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="使用Python监控Linux系统, Echo’s blog">
    <meta name="description" content="使用Python监控Linux系统Linux下有许多使用Python语言编写的监控工具，如inotify-sync、dstat和glances。此外，如果要根据业务编写简单的监控脚本，很多工程师也会选择Python语言。Python语言是一">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>使用Python监控Linux系统 | Echo’s blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.1.0"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Echo’s blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Echo’s blog</div>
        <div class="logo-desc">
            
            人的一生就是一个储蓄的过程，在奋斗的时候储存了希望；在耕耘的时候储存了一粒种子；在旅行的时候储存了风景；在微笑的时候储存了快乐。聪明的人善于储蓄，在漫长而短暂的人生旅途中，学会储蓄每一个闪光的瞬间，然后用它们酿成一杯美好的回忆，在四季的变幻与交替之间，散发浓香，珍藏一生
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/Gilbert2/echo.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/Gilbert2/echo.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/3.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">使用Python监控Linux系统</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Python/">
                                <span class="chip bg-color">Python</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Python/" class="post-category">
                                Python
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-05-12
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="使用Python监控Linux系统"><a href="#使用Python监控Linux系统" class="headerlink" title="使用Python监控Linux系统"></a>使用Python监控Linux系统</h2><p>Linux下有许多使用Python语言编写的监控工具，如inotify-sync、dstat和glances。此外，如果要根据业务编写简单的监控脚本，很多工程师也会选择Python语言。Python语言是一门简单易学&#x2F;语法清晰&#x2F;表达能力强的编程语言，非常适合于编写监控程序的场景。使用Python语言编写监控程序具有以下几个优势：</p>
<p>1、Python语言开发效率高。Python语言有自己的优势与劣势，使用Python开发监控程序是一个充分发挥Python优势，避免Python劣势的领域。对于监控程序来说，能够利用Python语言开发效率高的优势尽快完成程序的编写工作。同时，监控程序也不要求性能，因此避免了Python语言性能不如C、C++和Java的劣势。</p>
<p>2、Python语言表达能力强。相信任何一个学习Linux的工程师都使用过shell脚本编写过监控程序。虽然Linux下有很多监控工具，也有很多文本处理程序，但是获取监控与解析结果是完全不同的工具。解析监控结果的程序不理解监控程序输出结果的具体含义。Python语言中有非常丰富的数据结构，可以用各种方式保存监控结果，以便后续处理。</p>
<p>3、利用第三方库开发监控程序。Python的标准库本身非常强大，被称为“连电池都包含在内”。对于一个问题，如果标准库没有提供相应的工具，那么也会有开源的项目来填补这个空白。监控程序正式这样一种情况，在Python语言中，具有非常成熟的第三方库帮助开发者简化监控程序的编写工作。</p>
<h3 id="一、Python编写的监控工具"><a href="#一、Python编写的监控工具" class="headerlink" title="一、Python编写的监控工具"></a>一、Python编写的监控工具</h3><p>我们将介绍两个Python语言编写的监控工具，分别是dstat和glances。</p>
<h4 id="1、多功能系统资源统计工具dstat"><a href="#1、多功能系统资源统计工具dstat" class="headerlink" title="1、多功能系统资源统计工具dstat"></a>1、多功能系统资源统计工具dstat</h4><p>dstat是一个用Python语言实现的多功能系统资源统计工具，用来取代Linux下的vmstat、iostat、netstat、和ifstat等命令。并且，dstat克服了这些命令的限制，增加了额外的功能，以及更多的计数器与更好的灵活性。dstat可以在一个界面上展示非常全面的监控信息，因此，在系统监控、基准测试和故障排除等应用场景下特别有用。</p>
<p>我们可以使用dstat监控所有系统资源的使用情况，并且可以结合不同的场景定制监控的资源。例如，在同一时间段以相同的时间频率比较网络带宽与磁盘的吞吐率。</p>
<p>dstat将以列表的形式显示监控信息，并且使用不同的颜色进行输出，以可读性较强的单位展示监控数值。例如，对于字节数值，dstat自动根据数值的大小，以K、M、G等单位进行显示，避免了开发者使用其他命令时因为数值太大造成的困惑和错误。此外，使用dstat还可以非常方便地编写插件，用来收集默认情况下没有收到的监控信息。dstat是专门为人们实时查看监控信息设计的，因此默认将监控结果输出到屏幕终端。我们也可以将监控信息以CSV格式输出到文件，以便后续处理。</p>
<h5 id="（1）dstat介绍"><a href="#（1）dstat介绍" class="headerlink" title="（1）dstat介绍"></a>（1）dstat介绍</h5><p>作为一个多功能系统资源统计工具，dstat具有以下特性：</p>
<pre class="line-numbers language-tex" data-language="tex"><code class="language-tex">结合了vmstat，iostat，ifstat，netstat以及更多的信息
实时显示统计情况
在分析和排障时可以通过启用监控项并排序
模块化设计
使用python编写的，更方便扩展现有的工作任务
容易扩展和添加你的计数器（请为此做出贡献）
包含的许多扩展插件充分说明了增加新的监控项目是很方便的
可以分组统计块设备&#x2F;网络设备，并给出总数
可以显示每台设备的当前状态
极准确的时间精度，即便是系统负荷较高也不会延迟显示
显示准确地单位和和限制转换误差范围
用不同的颜色显示不同的单位
显示中间结果延时小于1秒
支持输出CSV格式报表，并能导入到Gnumeric和Excel以生成图形<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果操作系统默认没有安装dstat，那么需要我们手动进行安装。如下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yum <span class="token function">install</span> dstat<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>查看dstat命令的帮助信息与支持选项，如下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">dstat --help<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>dstat命令的–version选项，处理显示dstat的版本以外，还会显示操作系统的版本、Python语言的版本、CPU的个数，以及dstat支持的插件列表等详细信息。如下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@192 ~<span class="token punctuation">]</span><span class="token comment"># dstat --version</span>
Dstat <span class="token number">0.7</span>.2
Written by Dag Wieers <span class="token operator">&lt;</span>dag@wieers.com<span class="token operator">></span>
Homepage at http://dag.wieers.com/home-made/dstat/

Platform posix/linux2
Kernel <span class="token number">3.10</span>.0-957.el7.x86_64
Python <span class="token number">2.7</span>.5 <span class="token punctuation">(</span>default, Oct <span class="token number">30</span> <span class="token number">2018</span>, <span class="token number">23</span>:45:53<span class="token punctuation">)</span> 
<span class="token punctuation">[</span>GCC <span class="token number">4.8</span>.5 <span class="token number">20150623</span> <span class="token punctuation">(</span>Red Hat <span class="token number">4.8</span>.5-36<span class="token punctuation">)</span><span class="token punctuation">]</span>

Terminal type: xterm <span class="token punctuation">(</span>color support<span class="token punctuation">)</span>
Terminal size: <span class="token number">16</span> lines, <span class="token number">83</span> columns

Processors: <span class="token number">1</span>
Pagesize: <span class="token number">4096</span>
Clock ticks per secs: <span class="token number">100</span>

internal:
	aio, cpu, cpu24, disk, disk24, disk24old, epoch, fs, int, int24, io, ipc, 
	load, lock, mem, net, page, page24, proc, raw, socket, swap, swapold, 
	sys, tcp, time, udp, unix, vm
/usr/share/dstat:
	battery, battery-remain, cpufreq, dbus, disk-tps, disk-util, dstat, 
	dstat-cpu, dstat-ctxt, dstat-mem, fan, freespace, gpfs, gpfs-ops, 
	helloworld, innodb-buffer, innodb-io, innodb-ops, lustre, memcache-hits, 
	mysql-io, mysql-keys, mysql5-cmds, mysql5-conn, mysql5-io, mysql5-keys, 
	net-packets, nfs3, nfs3-ops, nfsd3, nfsd3-ops, ntp, postfix, power, 
	proc-count, qmail, rpc, rpcd, sendmail, snooze, squid, test, thermal, 
	top-bio, top-bio-adv, top-childwait, top-cpu, top-cpu-adv, top-cputime, 
	top-cputime-avg, top-int, top-io, top-io-adv, top-latency, 
	top-latency-avg, top-mem, top-oom, utmp, vm-memctl, vmk-hba, vmk-int, 
	vmk-nic, vz-cpu, vz-io, vz-ubc, wifi
<span class="token punctuation">[</span>root@192 ~<span class="token punctuation">]</span><span class="token comment"># </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>除了使用dstat命令的–version选项查看dstat的详细信息获取可支持的插件以外，还可以使用dstat命令的–list选项获取dstat的插件列表。如下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@192 ~<span class="token punctuation">]</span><span class="token comment"># dstat --list</span>
internal:
	aio, cpu, cpu24, disk, disk24, disk24old, epoch, fs, int, int24, io, ipc, load, lock, mem, net, page, page24, 
	proc, raw, socket, swap, swapold, sys, tcp, time, udp, unix, vm
/usr/share/dstat:
	battery, battery-remain, cpufreq, dbus, disk-tps, disk-util, dstat, dstat-cpu, dstat-ctxt, dstat-mem, fan, 
	freespace, gpfs, gpfs-ops, helloworld, innodb-buffer, innodb-io, innodb-ops, lustre, memcache-hits, mysql-io, 
	mysql-keys, mysql5-cmds, mysql5-conn, mysql5-io, mysql5-keys, net-packets, nfs3, nfs3-ops, nfsd3, nfsd3-ops, ntp, 
	postfix, power, proc-count, qmail, rpc, rpcd, sendmail, snooze, squid, test, thermal, top-bio, top-bio-adv, 
	top-childwait, top-cpu, top-cpu-adv, top-cputime, top-cputime-avg, top-int, top-io, top-io-adv, top-latency, 
	top-latency-avg, top-mem, top-oom, utmp, vm-memctl, vmk-hba, vmk-int, vmk-nic, vz-cpu, vz-io, vz-ubc, wifi
<span class="token punctuation">[</span>root@192 ~<span class="token punctuation">]</span><span class="token comment"># </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>直接在终端输入dstat命令，dstat将以默认参数运行。默认情况下，dstat会收集CPU、磁盘、网络、交换页和系统消息，并以1秒钟1次的频率进行输出，直到我们按Ctrl+C结束。</p>
<h5 id="（2）dstat常用选项"><a href="#（2）dstat常用选项" class="headerlink" title="（2）dstat常用选项"></a>（2）dstat常用选项</h5><p>如下所示，dstat会提示我们没有指定任何参数，因此使用-cdngy参数运行。</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@192 ~<span class="token punctuation">]</span><span class="token comment"># dstat</span>
You did not <span class="token keyword">select</span> any stats, using -cdngy by default.
----total-cpu-usage---- -dsk/total- -net/total- ---paging-- ---system--
usr sys idl wai hiq siq<span class="token operator">|</span> <span class="token builtin class-name">read</span>  writ<span class="token operator">|</span> recv  send<span class="token operator">|</span>  <span class="token keyword">in</span>   out <span class="token operator">|</span> int   csw 
  <span class="token number">9</span>   <span class="token number">3</span>  <span class="token number">88</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span> 219k   60k<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>2682B 5427B<span class="token operator">|</span> <span class="token number">163</span>  <span class="token number">1542</span> 
 <span class="token number">20</span>   <span class="token number">5</span>  <span class="token number">75</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  894B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">326</span>  <span class="token number">4218</span> 
 <span class="token number">19</span>   <span class="token number">6</span>  <span class="token number">75</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> 126B  410B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">330</span>  <span class="token number">4431</span> 
 <span class="token number">18</span>   <span class="token number">7</span>  <span class="token number">75</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  416B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">341</span>  <span class="token number">2998</span> 
 <span class="token number">20</span>   <span class="token number">6</span>  <span class="token number">74</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  350B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">340</span>  <span class="token number">4098</span> 
 <span class="token number">19</span>   <span class="token number">6</span>  <span class="token number">75</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  350B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">319</span>  <span class="token number">4010</span> 
 <span class="token number">20</span>   <span class="token number">5</span>  <span class="token number">75</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  350B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">326</span>  <span class="token number">4378</span> 
 <span class="token number">19</span>   <span class="token number">6</span>  <span class="token number">75</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  350B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">322</span>  <span class="token number">4407</span> 
 <span class="token number">20</span>   <span class="token number">5</span>  <span class="token number">75</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  350B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">332</span>  <span class="token number">4520</span> 
 <span class="token number">21</span>   <span class="token number">6</span>  <span class="token number">73</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>1140k    <span class="token number">0</span> <span class="token operator">|</span>  66B  350B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">345</span>  <span class="token number">3341</span> 
 <span class="token number">20</span>   <span class="token number">7</span>  <span class="token number">72</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  358B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">348</span>  <span class="token number">3821</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>常用选项如下：</p>
<blockquote>
<p>直接跟数字，表示#秒收集一次数据，默认为一秒；dstat 5表示5秒更新一次</p>
</blockquote>
<pre class="line-numbers language-tex" data-language="tex"><code class="language-tex">-c,--cpu  统计CPU状态，包括system, user, idle, wait, hardware interrupt, software interrupt等；
-d, --disk 统计磁盘读写状态
-D total,sda 统计指定磁盘或汇总信息
-l, --load 统计系统负载情况，包括1分钟、5分钟、15分钟平均值
-m, --mem 统计系统物理内存使用情况，包括used, buffers, cache, free
-s, --swap 统计swap已使用和剩余量
-n, --net 统计网络使用情况，包括接收和发送数据
-N eth1,total  统计eth1接口汇总流量
-r, --io 统计I&#x2F;O请求，包括读写请求
-p, --proc 统计进程信息，包括runnable、uninterruptible、new
-y, --sys 统计系统信息，包括中断、上下文切换
-t 显示统计时时间，对分析历史数据非常有用
--fs 统计文件打开数和inodes数<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>除了前面介绍的与监控相关的参数以外，dstat还可以像vmstat和iostat一样使用参数控制报告的时间间隔，或者同事指定时间间隔与报告次数。</p>
<p>例如，下面的命令表示以默认的选项运行dstat，每2秒钟输出一条监控信息，并在输出10条监控信息以后退出dstat。如下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@192 ~<span class="token punctuation">]</span><span class="token comment"># dstat 2 10</span>
You did not <span class="token keyword">select</span> any stats, using -cdngy by default.
----total-cpu-usage---- -dsk/total- -net/total- ---paging-- ---system--
usr sys idl wai hiq siq<span class="token operator">|</span> <span class="token builtin class-name">read</span>  writ<span class="token operator">|</span> recv  send<span class="token operator">|</span>  <span class="token keyword">in</span>   out <span class="token operator">|</span> int   csw 
  <span class="token number">9</span>   <span class="token number">3</span>  <span class="token number">88</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span> 218k   60k<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>2674B 5409B<span class="token operator">|</span> <span class="token number">164</span>  <span class="token number">1550</span> 
 <span class="token number">20</span>   <span class="token number">6</span>  <span class="token number">74</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  594B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">326</span>  <span class="token number">3956</span> 
 <span class="token number">21</span>   <span class="token number">6</span>  <span class="token number">73</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>   147k<span class="token operator">|</span>  66B  346B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">360</span>  <span class="token number">4114</span> 
 <span class="token number">20</span>   <span class="token number">5</span>  <span class="token number">76</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  346B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">320</span>  <span class="token number">4494</span> 
 <span class="token number">20</span>   <span class="token number">6</span>  <span class="token number">74</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  96B  372B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">349</span>  <span class="token number">4144</span> 
 <span class="token number">20</span>   <span class="token number">5</span>  <span class="token number">75</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  342B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">331</span>  <span class="token number">4360</span> 
 <span class="token number">21</span>   <span class="token number">6</span>  <span class="token number">74</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  342B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">344</span>  <span class="token number">3607</span> 
 <span class="token number">19</span>   <span class="token number">6</span>  <span class="token number">75</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  342B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">334</span>  <span class="token number">4475</span> 
 <span class="token number">21</span>   <span class="token number">6</span>  <span class="token number">74</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  342B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">338</span>  <span class="token number">4580</span> 
 <span class="token number">20</span>   <span class="token number">7</span>  <span class="token number">73</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  342B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">340</span>  <span class="token number">4341</span> 
 <span class="token number">20</span>   <span class="token number">6</span>  <span class="token number">74</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  342B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">344</span>  <span class="token number">3899</span> 
<span class="token punctuation">[</span>root@192 ~<span class="token punctuation">]</span><span class="token comment"># </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="（3）dstat高级用法"><a href="#（3）dstat高级用法" class="headerlink" title="（3）dstat高级用法"></a>（3）dstat高级用法</h5><p>dstat的强大之处不仅仅是因为它聚合了多种工具的监控结果，还因为它能通过附带的插件实现一些更高级功能。如：找出磁盘中占用资源最高的进程和用户。</p>
<p>dstat -cdlmnpsyt 5 可以得到较全面的系统性能数据。</p>
<p>dstat的–top-(io|bio|cpu|cputime|cputime-avg|mem) 通过这几个选项，可以看到具体是哪个用户哪个进程占用了相关系统资源，对系统调优非常有效。如查看当前占用I&#x2F;O、cpu、内存等最高的进程信息可以使用dstat –top-mem –top-io –top-cpu选项。以下示例演示了如何找出占用资源最多的进程。</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@192 ~<span class="token punctuation">]</span><span class="token comment"># dstat --top-mem --top-io --top-cpu</span>
--most-expensive- ----most-expensive---- -most-expensive-
  memory process <span class="token operator">|</span>     i/o process      <span class="token operator">|</span>  cpu process   
gnome-shell  115M<span class="token operator">|</span>polkitd     203k   10k<span class="token operator">|</span>polkitd      <span class="token number">3.8</span>
gnome-shell  115M<span class="token operator">|</span>polkitd     459k   23k<span class="token operator">|</span>polkitd       <span class="token number">10</span>
gnome-shell  115M<span class="token operator">|</span>polkitd     625k   31k<span class="token operator">|</span>polkitd      <span class="token number">9.0</span>
gnome-shell  115M<span class="token operator">|</span>polkitd     592k   29k<span class="token operator">|</span>dbus-daemon  <span class="token number">8.0</span>
gnome-shell  115M<span class="token operator">|</span>polkitd     606k   30k<span class="token operator">|</span>polkitd      <span class="token number">9.0</span>
gnome-shell  115M<span class="token operator">|</span>polkitd     525k   26k<span class="token operator">|</span>polkitd       <span class="token number">10</span>
gnome-shell  115M<span class="token operator">|</span>polkitd     525k   26k<span class="token operator">|</span>dbus-daemon  <span class="token number">8.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>dstat的插件保存在&#x2F;usr&#x2F;share&#x2F;dstat目录下，我们可以参考它们的实现，编写自己的插件。</p>
<h5 id="（4）将结果输出到CSV文件"><a href="#（4）将结果输出到CSV文件" class="headerlink" title="（4）将结果输出到CSV文件"></a>（4）将结果输出到CSV文件</h5><p>dstat还可以将监控信息保存到CSV文件中，以便后续进行处理。通过–output选项指定监控数据输出的文件。如下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@192 ~<span class="token punctuation">]</span><span class="token comment"># dstat -a --output dstat_output.csv</span>
----total-cpu-usage---- -dsk/total- -net/total- ---paging-- ---system--
usr sys idl wai hiq siq<span class="token operator">|</span> <span class="token builtin class-name">read</span>  writ<span class="token operator">|</span> recv  send<span class="token operator">|</span>  <span class="token keyword">in</span>   out <span class="token operator">|</span> int   csw 
  <span class="token number">9</span>   <span class="token number">3</span>  <span class="token number">88</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span> 217k   60k<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>2656B 5370B<span class="token operator">|</span> <span class="token number">165</span>  <span class="token number">1568</span> 
 <span class="token number">19</span>   <span class="token number">8</span>  <span class="token number">50</span>  <span class="token number">22</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>  11M   50k<span class="token operator">|</span>  66B  838B<span class="token operator">|</span> 128k    <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">428</span>  <span class="token number">3116</span> 
 <span class="token number">19</span>   <span class="token number">6</span>  <span class="token number">75</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  374B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">325</span>  <span class="token number">4514</span> 
 <span class="token number">25</span>   <span class="token number">7</span>  <span class="token number">25</span>  <span class="token number">43</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>5284k    <span class="token number">0</span> <span class="token operator">|</span>  66B  350B<span class="token operator">|</span> 476k    <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">448</span>  <span class="token number">4227</span> 
 <span class="token number">18</span>   <span class="token number">7</span>  <span class="token number">74</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span><span class="token operator">|</span>  32k  144k<span class="token operator">|</span>  66B  366B<span class="token operator">|</span>  52k    <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">334</span>  <span class="token number">4524</span> 
 <span class="token number">31</span>  <span class="token number">11</span>   <span class="token number">6</span>  <span class="token number">52</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>1944k 4096B<span class="token operator">|</span>  66B  374B<span class="token operator">|</span> 868k    <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">613</span>  <span class="token number">3846</span> 
 <span class="token number">19</span>   <span class="token number">6</span>  <span class="token number">69</span>   <span class="token number">6</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span> 116k 4096B<span class="token operator">|</span>  66B  374B<span class="token operator">|</span> 116k    <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">337</span>  <span class="token number">4367</span> 
 <span class="token number">20</span>   <span class="token number">6</span>  <span class="token number">74</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  374B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">331</span>  <span class="token number">4573</span> 
 <span class="token number">20</span>   <span class="token number">7</span>  <span class="token number">73</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  350B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">339</span>  <span class="token number">3787</span> 
 <span class="token number">18</span>   <span class="token number">6</span>  <span class="token number">76</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  350B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">317</span>  <span class="token number">4472</span> 
 <span class="token number">20</span>   <span class="token number">6</span>  <span class="token number">74</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  350B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">338</span>  <span class="token number">3675</span> 
 <span class="token number">20</span>   <span class="token number">5</span>  <span class="token number">75</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  350B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">324</span>  <span class="token number">4633</span> 
 <span class="token number">21</span>   <span class="token number">5</span>  <span class="token number">74</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  350B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">318</span>  <span class="token number">4597</span> 
 <span class="token number">19</span>   <span class="token number">6</span>  <span class="token number">75</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  350B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">333</span>  <span class="token number">4847</span> 
 <span class="token number">18</span>   <span class="token number">6</span>  <span class="token number">76</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span>  66B  350B<span class="token operator">|</span>   <span class="token number">0</span>     <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">308</span>  <span class="token number">4742</span> ^C
<span class="token punctuation">[</span>root@192 ~<span class="token punctuation">]</span><span class="token comment"># cat dstat_output.csv </span>
<span class="token string">"Dstat 0.7.2 CSV output"</span>
<span class="token string">"Author:"</span>,<span class="token string">"Dag Wieers &lt;dag@wieers.com>"</span>,,,,<span class="token string">"URL:"</span>,<span class="token string">"http://dag.wieers.com/home-made/dstat/"</span>
<span class="token string">"Host:"</span>,<span class="token string">"192.168.32.138"</span>,,,,<span class="token string">"User:"</span>,<span class="token string">"root"</span>
<span class="token string">"Cmdline:"</span>,<span class="token string">"dstat -a --output dstat_output.csv"</span>,,,,<span class="token string">"Date:"</span>,<span class="token string">"22 Feb 2020 00:22:08 CST"</span>

<span class="token string">"total cpu usage"</span>,,,,,,<span class="token string">"dsk/total"</span>,,<span class="token string">"net/total"</span>,,<span class="token string">"paging"</span>,,<span class="token string">"system"</span>,
<span class="token string">"usr"</span>,<span class="token string">"sys"</span>,<span class="token string">"idl"</span>,<span class="token string">"wai"</span>,<span class="token string">"hiq"</span>,<span class="token string">"siq"</span>,<span class="token string">"read"</span>,<span class="token string">"writ"</span>,<span class="token string">"recv"</span>,<span class="token string">"send"</span>,<span class="token string">"in"</span>,<span class="token string">"out"</span>,<span class="token string">"int"</span>,<span class="token string">"csw"</span>
<span class="token number">8.683</span>,2.816,88.156,0.313,0.0,0.032,222019.623,61103.678,0.0,0.0,2655.691,5370.227,164.807,1568.447
<span class="token number">19.388</span>,8.163,50.0,22.449,0.0,0.0,11702272.0,51200.0,66.0,838.0,131072.0,0.0,428.0,3116.0
<span class="token number">19.192</span>,6.061,74.747,0.0,0.0,0.0,0.0,0.0,66.0,374.0,0.0,0.0,325.0,4514.0
<span class="token number">24.510</span>,6.863,25.490,43.137,0.0,0.0,5410816.0,0.0,66.0,350.0,487424.0,0.0,448.0,4227.0
<span class="token number">18.182</span>,7.071,73.737,0.0,0.0,1.010,32768.0,147456.0,66.0,366.0,53248.0,0.0,334.0,4524.0
<span class="token number">30.928</span>,11.340,6.186,51.546,0.0,0.0,1990656.0,4096.0,66.0,374.0,888832.0,0.0,613.0,3846.0
<span class="token number">19.192</span>,6.061,68.687,6.061,0.0,0.0,118784.0,4096.0,66.0,374.0,118784.0,0.0,337.0,4367.0
<span class="token number">19.802</span>,5.941,74.257,0.0,0.0,0.0,0.0,0.0,66.0,374.0,0.0,0.0,331.0,4573.0
<span class="token number">20.0</span>,7.0,73.0,0.0,0.0,0.0,0.0,0.0,66.0,350.0,0.0,0.0,339.0,3787.0
<span class="token number">18.367</span>,6.122,75.510,0.0,0.0,0.0,0.0,0.0,66.0,350.0,0.0,0.0,317.0,4472.0
<span class="token number">20.0</span>,6.0,74.0,0.0,0.0,0.0,0.0,0.0,66.0,350.0,0.0,0.0,338.0,3675.0
<span class="token number">20.202</span>,5.051,74.747,0.0,0.0,0.0,0.0,0.0,66.0,350.0,0.0,0.0,324.0,4633.0
<span class="token number">21.0</span>,5.0,74.0,0.0,0.0,0.0,0.0,0.0,66.0,350.0,0.0,0.0,318.0,4597.0
<span class="token number">19.192</span>,6.061,74.747,0.0,0.0,0.0,0.0,0.0,66.0,350.0,0.0,0.0,333.0,4847.0
<span class="token number">18.182</span>,6.061,75.758,0.0,0.0,0.0,0.0,0.0,66.0,350.0,0.0,0.0,308.0,4742.0
<span class="token punctuation">[</span>root@192 ~<span class="token punctuation">]</span><span class="token comment"># </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="2、交互式监控工具glances"><a href="#2、交互式监控工具glances" class="headerlink" title="2、交互式监控工具glances"></a>2、交互式监控工具glances</h4><p>在紧急情况下，工程师需要在尽可能短的时间内查看尽可能多的信息。此时，glances是一个不错的选择。glances的设计初衷就是在当前窗口中尽可能多地显示系统消息。</p>
<p>glances是一款使用Python语言开发、基于psutil的跨平台系统监控工具，在所有Linux命令行工具中，它与top命令最相似，都是命令行交互监控工具。但是，glances实现了比top命令更齐全的接口，提供了更加丰富的功能。</p>
<h5 id="（1）glances提供的系统信息"><a href="#（1）glances提供的系统信息" class="headerlink" title="（1）glances提供的系统信息"></a>（1）glances提供的系统信息</h5><p>glances提供的系统信息如下所示：</p>
<pre class="line-numbers language-tex" data-language="tex"><code class="language-tex">CPU 使用率
内存使用情况
内核统计信息和运行队列信息
磁盘 I&#x2F;O 速度、传输和读&#x2F;写比率
文件系统中的可用空间
磁盘适配器
网络 I&#x2F;O 速度、传输和读&#x2F;写比率
页面空间和页面速度
消耗资源最多的进程
计算机信息和系统资源<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>glances 工具可以在用户的终端上实时显示重要的系统信息，并动态地对其进行更新。这个高效的工具可以工作于任何终端屏幕。另外它并不会消耗大量的 CPU 资源，通常低于百分之二。glances 在屏幕上对数据进行显示，并且每隔2秒钟对其进行更新。您也可以自己将这个时间间隔更改为更长或更短的数值。</p>
<p>glances 工具还可以将相同的数据捕获到一个文件，便于以后对报告进行分析和绘制图形。输出文件可以是电子表格的格式 (.csv) 或者 html 格式。</p>
<h5 id="（2）Linux下glances的安装"><a href="#（2）Linux下glances的安装" class="headerlink" title="（2）Linux下glances的安装"></a>（2）Linux下glances的安装</h5><p>在Linux系统中，可以使用yum命令或者pip命令安装glances。如下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">yum <span class="token function">install</span> epel-release
yum <span class="token function">install</span> glances<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>glances的使用非常简单，直接输入glances命令便进入了一个类似top命令的交互式界面。在这个界面中，显示了比top更加全面，更加具有可读性的信息。如下所示：</p>
<p>glances 工作界面的说明 :<br>在图 1 的上部是 CPU 、Load（负载）、Mem（内存使用）、 Swap（交换分区）的使用情况。在图 1 的中上部是网络接口、Processes（进程）的使用情况。通常包括如下字段：</p>
<pre class="line-numbers language-tex" data-language="tex"><code class="language-tex">VIRT: 虚拟内存大小
RES: 进程占用的物理内存值
%CPU：该进程占用的 CPU 使用率
%MEM：该进程占用的物理内存和总内存的百分比
PID: 进程 ID 号
USER: 进程所有者的用户名
TIME+: 该进程启动后占用的总的 CPU 时间
IO_R 和 IO_W: 进程的读写 I&#x2F;O 速率
NAME: 进程名称
NI: 进程优先级
S: 进程状态，其中 S 表示休眠，R 表示正在运行，Z 表示僵死状态。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="（3）glances的可读性"><a href="#（3）glances的可读性" class="headerlink" title="（3）glances的可读性"></a>（3）glances的可读性</h5><p>对比可以发现，glances对屏幕的利用率比top明显高很多，信息量很大，有许多top所没有显示的数据。而且，glances的实时变动比top颜值高太多了。</p>
<p>Glances 会用一下几种颜色来代表状态，如下所示：</p>
<pre class="line-numbers language-tex" data-language="tex"><code class="language-tex">绿色：OK（一切正常）
蓝色：CAREFUL（需要注意）
紫色：WARNING（警告）
红色：CRITICAL（严重）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="（4）glances常见命令"><a href="#（4）glances常见命令" class="headerlink" title="（4）glances常见命令"></a>（4）glances常见命令</h5><p>glances是一个交互式的工具，因此我们也可以输入命令来控制glances的行为。glances常见的命令有：</p>
<pre class="line-numbers language-tex" data-language="tex"><code class="language-tex">h：显示帮助信息
q：离开程序退出
c：按照 CPU 实时负载对系统进程进行排序
m：按照内存使用状况对系统进程排序
i：按照 I&#x2F;O 使用状况对系统进程排序
p：按照进程名称排序
d：显示磁盘读写状况
w：删除日志文件
l：显示日志
s：显示传感器信息
f：显示系统信息
1：轮流显示每个 CPU 内核的使用情况（次选项仅仅使用在多核 CPU 系统）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>glances还支持将采集的数据导入到其他服务中心，包括InfluxDB、Cassandra、CouchDB、OpenTSDB、Prometheus、StatsD、ElasticSearch、RabbitMQ&#x2F;ActiveMQ、ZeroMQ、Kafaka和Riemann。</p>
<h3 id="二、Python监控Linux"><a href="#二、Python监控Linux" class="headerlink" title="二、Python监控Linux"></a>二、Python监控Linux</h3><p>shell查看磁盘的监控信息，如下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@bogon proc<span class="token punctuation">]</span><span class="token comment"># cat /proc/diskstats </span>
   <span class="token number">8</span>       <span class="token number">0</span> sda <span class="token number">85935</span> <span class="token number">21845</span> <span class="token number">10913707</span> <span class="token number">101067</span> <span class="token number">3119</span> <span class="token number">81257</span> <span class="token number">743486</span> <span class="token number">15647</span> <span class="token number">0</span> <span class="token number">31410</span> <span class="token number">109079</span>
   <span class="token number">8</span>       <span class="token number">1</span> sda1 <span class="token number">1822</span> <span class="token number">0</span> <span class="token number">12456</span> <span class="token number">397</span> <span class="token number">4</span> <span class="token number">0</span> <span class="token number">4096</span> <span class="token number">74</span> <span class="token number">0</span> <span class="token number">457</span> <span class="token number">462</span>
   <span class="token number">8</span>       <span class="token number">2</span> sda2 <span class="token number">84082</span> <span class="token number">21845</span> <span class="token number">10897907</span> <span class="token number">100659</span> <span class="token number">3115</span> <span class="token number">81257</span> <span class="token number">739390</span> <span class="token number">15573</span> <span class="token number">0</span> <span class="token number">30950</span> <span class="token number">108604</span>
  <span class="token number">11</span>       <span class="token number">0</span> sr0 <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>
 <span class="token number">253</span>       <span class="token number">0</span> dm-0 <span class="token number">80726</span> <span class="token number">0</span> <span class="token number">10688467</span> <span class="token number">99971</span> <span class="token number">2275</span> <span class="token number">0</span> <span class="token number">82606</span> <span class="token number">10224</span> <span class="token number">0</span> <span class="token number">27927</span> <span class="token number">110196</span>
 <span class="token number">253</span>       <span class="token number">1</span> dm-1 <span class="token number">25123</span> <span class="token number">0</span> <span class="token number">205184</span> <span class="token number">7367</span> <span class="token number">82098</span> <span class="token number">0</span> <span class="token number">656784</span> <span class="token number">616558</span> <span class="token number">0</span> <span class="token number">5167</span> <span class="token number">623924</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>编写一个Python脚本，监控磁盘信息，如下所示：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#/usr/bin/python</span>
<span class="token comment">#_*_ coding:utf-8 _*_</span>

<span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function
<span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple

disk  <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'Disk'</span><span class="token punctuation">,</span><span class="token string">'major_number minor_number device_name'</span>
                <span class="token string">' read_count read_merged_count read_sections'</span>
                <span class="token string">' time_spent_reading write_count write_merged_count'</span>
                <span class="token string">' write_sections time_spent_write io_requests'</span>
                <span class="token string">' time_spent_doing_io weighted_time_spent_dong_io'</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">get_disk_info</span><span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/proc/diskstats'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>
                        <span class="token keyword">if</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> device<span class="token punctuation">:</span>
                                <span class="token keyword">return</span> disk<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">raise</span> RuntimeError<span class="token punctuation">(</span><span class="token string">'设备(&#123;0&#125;)没找到。。。'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        disk_info <span class="token operator">=</span> get_disk_info<span class="token punctuation">(</span><span class="token string">'sda1'</span><span class="token punctuation">)</span>

        <span class="token keyword">print</span><span class="token punctuation">(</span>disk_info<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
        main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="三、使用开源库监控Linux"><a href="#三、使用开源库监控Linux" class="headerlink" title="三、使用开源库监控Linux"></a>三、使用开源库监控Linux</h3><p>在这一小节，我们将介绍一个在Python生态中广泛使用的开源项目，即psutil。随后，我们将使用psutil重构前一小节编写的监控程序。另外，还会简单介绍psutil提供的进程管理功能。</p>
<h4 id="1、psutil介绍"><a href="#1、psutil介绍" class="headerlink" title="1、psutil介绍"></a>1、psutil介绍</h4><blockquote>
<p>psutil &#x3D; process and system utilities</p>
</blockquote>
<p>psutil是一个开源且跨平台的库，其提供了便利的函数用来获取操作系统的信息，比如CPU，内存，磁盘，网络等。此外，psutil还可以用来进行进程管理，包括判断进程是否存在、获取进程列表、获取进程详细信息等。而且psutil还提供了许多命令行工具提供的功能，包括：ps，top，lsof，netstat，ifconfig， who，df，kill，free，nice，ionice，iostat，iotop，uptime，pidof，tty，taskset，pmap。</p>
<p>psutil是一个跨平台的库，支持Linux、Windows、OSX、FreeBSD、OpenBSD、NetBSD、Sun Solaris、AIX等操作系统。同时，psutil也支持32位与64位的系统架构，支持Python2.6到Python3.x之间的所有Python版本。</p>
<p>psutil具有简单易用、功能强大、跨平台等诸多优点，广泛应用于开源项目中，比较有名的有glances、Facebook的osquery、Google的grr等。psutil不但广泛应用于Python语言开发的开源项目中，还被移植到了其他编程语言中，如Go语言的gopsutil、C语言的cpslib、Rust语言的rust-psutil、Ruby语言的posixpsutil等。</p>
<p>psutil是一个第三方的开源项目，因此，需要先安装才能够使用。如果安装了Anaconda，psutil就已经可用了。否则，需要在命令行下通过pip安装：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pip install psutil</span>
Collecting psutil
  Downloading psutil-5.7.0.tar.gz <span class="token punctuation">(</span><span class="token number">449</span> kB<span class="token punctuation">)</span>
     <span class="token operator">|</span>████████████████████████████████<span class="token operator">|</span> <span class="token number">449</span> kB <span class="token number">4.6</span> kB/s 
Installing collected packages: psutil
    Running setup.py <span class="token function">install</span> <span class="token keyword">for</span> psutil <span class="token punctuation">..</span>. <span class="token keyword">done</span>
Successfully installed psutil-5.7.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>psutil包含了异常、类、功能函数和常量，其中功能函数用来获取系统的信息，如CPU、磁盘、内存、网络等。类用来实现进程的管理功能。</p>
<h4 id="2、psutil提供的功能函数"><a href="#2、psutil提供的功能函数" class="headerlink" title="2、psutil提供的功能函数"></a>2、psutil提供的功能函数</h4><p>根据函数的功能，主要分为CPU、磁盘、内存、网络几类，下面将会总几个方面来介绍psutil提供的功能函数。在这一小节，我们也将学习如何使用psutil来简化使用shell脚本获取监控信息的程序，并获取CPU、内存、磁盘和网络等不同维度。</p>
<h5 id="（1）CPU"><a href="#（1）CPU" class="headerlink" title="（1）CPU"></a>（1）CPU</h5><p>与CPU相关的功能函数如下：</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>psutil.cpu_count()</td>
<td>cpu_count(,[logical]):默认返回逻辑CPU的个数,当设置logical的参数为False时，返回物理CPU的个数。</td>
</tr>
<tr>
<td>psutil.cpu_percent()</td>
<td>cpu_percent(,[percpu],[interval])：返回CPU的利用率,percpu为True时显示所有物理核心的利用率,interval不为0时,则阻塞时显示interval执行的时间内的平均利用率</td>
</tr>
<tr>
<td>psutil.cpu_times()</td>
<td>cpu_times(,[percpu])：以命名元组(namedtuple)的形式返回cpu的时间花费,percpu&#x3D;True表示获取每个CPU的时间花费</td>
</tr>
<tr>
<td>psutil.cpu_times_percent()</td>
<td>cpu_times_percent(,[percpu])：功能和cpu_times大致相同，看字面意思就能知道，该函数返回的是耗时比例。</td>
</tr>
<tr>
<td>psutil.cpu_stats()</td>
<td>cpu_stats()以命名元组的形式返回CPU的统计信息，包括上下文切换，中断，软中断和系统调用次数。</td>
</tr>
<tr>
<td>psutil.cpu_freq()</td>
<td>cpu_freq([percpu])：返回cpu频率</td>
</tr>
</tbody></table>
<h6 id="1）cpu-count"><a href="#1）cpu-count" class="headerlink" title="1）cpu_count"></a>1）cpu_count</h6><blockquote>
<p>默认返回逻辑CPU的个数,当设置logical的参数为False时，返回物理CPU的个数。</p>
</blockquote>
<pre class="line-numbers language-pyth" data-language="pyth"><code class="language-pyth">In [1]: import psutil                                                              

In [2]: psutil.cpu_count()                                                         
Out[2]: 2

In [3]: psutil.cpu_count(logical&#x3D;False)                                            
Out[3]: 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="2）cpu-percent"><a href="#2）cpu-percent" class="headerlink" title="2）cpu_percent"></a>2）cpu_percent</h6><blockquote>
<p>返回CPU的利用率，percpu为True时显示所有物理核心的利用率，interval不为0时，则阻塞时显示interval执行的时间内的平均利用率。</p>
</blockquote>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>cpu_percent<span class="token punctuation">(</span><span class="token punctuation">)</span>                                                       
Out<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">1.5</span>

In <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>cpu_percent<span class="token punctuation">(</span>percpu<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>                                            
Out<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1.3</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">]</span>

In <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>cpu_percent<span class="token punctuation">(</span>percpu<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>interval<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>                                 
Out<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="3）cpu-times"><a href="#3）cpu-times" class="headerlink" title="3）cpu_times"></a>3）cpu_times</h6><p>以命名元组(namedtuple)的形式返回cpu的时间花费，percpu&#x3D;True表示获取每个CPU的时间花费。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>cpu_times<span class="token punctuation">(</span><span class="token punctuation">)</span>                                                         
Out<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">:</span> scputimes<span class="token punctuation">(</span>user<span class="token operator">=</span><span class="token number">41.51</span><span class="token punctuation">,</span> nice<span class="token operator">=</span><span class="token number">2.05</span><span class="token punctuation">,</span> system<span class="token operator">=</span><span class="token number">35.36</span><span class="token punctuation">,</span> idle<span class="token operator">=</span><span class="token number">2096.05</span><span class="token punctuation">,</span> iowait<span class="token operator">=</span><span class="token number">5.45</span><span class="token punctuation">,</span> irq<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> softirq<span class="token operator">=</span><span class="token number">1.31</span><span class="token punctuation">,</span> steal<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> guest<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> guest_nice<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">)</span>

In <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>cpu_times_percent<span class="token punctuation">(</span><span class="token punctuation">)</span>                                                 
Out<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">:</span> scputimes<span class="token punctuation">(</span>user<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> nice<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> system<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> idle<span class="token operator">=</span><span class="token number">99.5</span><span class="token punctuation">,</span> iowait<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> irq<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> softirq<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> steal<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> guest<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> guest_nice<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="4）cpu-stats"><a href="#4）cpu-stats" class="headerlink" title="4）cpu_stats"></a>4）cpu_stats</h6><p>以命名元组的形式返回CPU的统计信息，包括上下文切换，中断，软中断和系统调用次数。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>cpu_stats<span class="token punctuation">(</span><span class="token punctuation">)</span>                                                        
Out<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> scpustats<span class="token punctuation">(</span>ctx_switches<span class="token operator">=</span><span class="token number">538642</span><span class="token punctuation">,</span> interrupts<span class="token operator">=</span><span class="token number">238329</span><span class="token punctuation">,</span> soft_interrupts<span class="token operator">=</span><span class="token number">273448</span><span class="token punctuation">,</span> syscalls<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h6 id="5）cpu-freq"><a href="#5）cpu-freq" class="headerlink" title="5）cpu_freq"></a>5）cpu_freq</h6><p>返回cpu频率。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>cpu_freq<span class="token punctuation">(</span><span class="token punctuation">)</span>                                                         
Out<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">:</span> scpufreq<span class="token punctuation">(</span>current<span class="token operator">=</span><span class="token number">2394.464</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h5 id="（2）内存"><a href="#（2）内存" class="headerlink" title="（2）内存"></a>（2）内存</h5><p>与内存相关的功能函数如下：</p>
<h6 id="1）virtual-memory"><a href="#1）virtual-memory" class="headerlink" title="1）virtual_memory"></a>1）virtual_memory</h6><p>以命名元组的形式返回内存使用情况，包括总内存、可用内存、内存利用率、buffer和cache等。除了内存利用率，其它字段都以字节为单位返回。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">import</span> psutil                                                              

In <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>virtual_memory<span class="token punctuation">(</span><span class="token punctuation">)</span>                                                    
Out<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span> svmem<span class="token punctuation">(</span>total<span class="token operator">=</span><span class="token number">1019797504</span><span class="token punctuation">,</span> available<span class="token operator">=</span><span class="token number">95744000</span><span class="token punctuation">,</span> percent<span class="token operator">=</span><span class="token number">90.6</span><span class="token punctuation">,</span> used<span class="token operator">=</span><span class="token number">758079488</span><span class="token punctuation">,</span> free<span class="token operator">=</span><span class="token number">67502080</span><span class="token punctuation">,</span> active<span class="token operator">=</span><span class="token number">295485440</span><span class="token punctuation">,</span> inactive<span class="token operator">=</span><span class="token number">417394688</span><span class="token punctuation">,</span> buffers<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> cached<span class="token operator">=</span><span class="token number">194215936</span><span class="token punctuation">,</span> shared<span class="token operator">=</span><span class="token number">19103744</span><span class="token punctuation">,</span> slab<span class="token operator">=</span><span class="token number">92905472</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>单位转换</p>
</blockquote>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#/usr/bin/python</span>
<span class="token comment">#-*- conding:utf-8 _*_</span>

<span class="token keyword">import</span> psutil

<span class="token keyword">def</span> <span class="token function">bytes2human</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
     symbols <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'K'</span><span class="token punctuation">,</span><span class="token string">'M'</span><span class="token punctuation">,</span><span class="token string">'G'</span><span class="token punctuation">,</span><span class="token string">'T'</span><span class="token punctuation">,</span><span class="token string">'P'</span><span class="token punctuation">,</span><span class="token string">'E'</span><span class="token punctuation">,</span><span class="token string">'Z'</span><span class="token punctuation">,</span><span class="token string">'Y'</span><span class="token punctuation">)</span>
     prefix <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
     <span class="token keyword">for</span> i<span class="token punctuation">,</span>s <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>symbols<span class="token punctuation">)</span><span class="token punctuation">:</span>
         prefix<span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span>
     <span class="token keyword">for</span> s <span class="token keyword">in</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span>symbols<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token keyword">if</span> n <span class="token operator">>=</span> prefix<span class="token punctuation">[</span>s<span class="token punctuation">]</span><span class="token punctuation">:</span>
             value <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">/</span> prefix<span class="token punctuation">[</span>s<span class="token punctuation">]</span>
             <span class="token keyword">return</span> <span class="token string">'%.1f%s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>value<span class="token punctuation">,</span>s<span class="token punctuation">)</span>
     <span class="token keyword">return</span> <span class="token string">'%sB'</span> <span class="token operator">%</span> n

<span class="token keyword">print</span><span class="token punctuation">(</span>bytes2human<span class="token punctuation">(</span>psutil<span class="token punctuation">.</span>virtual_memory<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>total<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行结果如下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># python mem.py </span>
<span class="token number">972</span>.6M<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h6 id="2）swap-memory"><a href="#2）swap-memory" class="headerlink" title="2）swap_memory"></a>2）swap_memory</h6><p>以命名元组的形式返回swap&#x2F;memory使用情况，包含swap中页的换入和换出。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>swap_memory<span class="token punctuation">(</span><span class="token punctuation">)</span>                                                       
Out<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span> sswap<span class="token punctuation">(</span>total<span class="token operator">=</span><span class="token number">2147479552</span><span class="token punctuation">,</span> used<span class="token operator">=</span><span class="token number">141819904</span><span class="token punctuation">,</span> free<span class="token operator">=</span><span class="token number">2005659648</span><span class="token punctuation">,</span> percent<span class="token operator">=</span><span class="token number">6.6</span><span class="token punctuation">,</span> sin<span class="token operator">=</span><span class="token number">24666112</span><span class="token punctuation">,</span> sout<span class="token operator">=</span><span class="token number">147292160</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h5 id="（3）磁盘"><a href="#（3）磁盘" class="headerlink" title="（3）磁盘"></a>（3）磁盘</h5><p>与磁盘相关的功能如下：</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>psutil.disk_io_counters()</td>
<td>disk_io_counters([perdisk])：以命名元组的形式返回磁盘io统计信息(汇总的)，包括读、写的次数，读、写的字节数等。 当perdisk的值为True，则分别列出单个磁盘的统计信息(字典：key为磁盘名称，value为统计的namedtuple)。</td>
</tr>
<tr>
<td>psutil.disk_partitions()</td>
<td>disk_partitions([all&#x3D;False])：以命名元组的形式返回所有已挂载的磁盘，包含磁盘名称，挂载点，文件系统类型等信息。 当all等于True时，返回包含&#x2F;proc等特殊文件系统的挂载信息</td>
</tr>
<tr>
<td>psutil.disk_usage()</td>
<td>disk_usage(path)：以命名元组的形式返回path所在磁盘的使用情况，包括磁盘的容量、已经使用的磁盘容量、磁盘的空间利用率等。</td>
</tr>
</tbody></table>
<h6 id="1）psutil-disk-io-counters"><a href="#1）psutil-disk-io-counters" class="headerlink" title="1）psutil.disk_io_counters"></a>1）psutil.disk_io_counters</h6><p>以命名元组的形式返回磁盘io统计信息(汇总的)，包括读、写的次数，读、写的字节数等。 当perdisk的值为True，则分别列出单个磁盘的统计信息(字典：key为磁盘名称，value为统计的namedtuple)。有了disk_io_counters函数，省去了解析&#x2F;proc&#x2F;diskstats文件的烦恼。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">import</span> psutil                                                              

In <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>disk_io_counters<span class="token punctuation">(</span><span class="token punctuation">)</span>                                                  
Out<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span> sdiskio<span class="token punctuation">(</span>read_count<span class="token operator">=</span><span class="token number">86913</span><span class="token punctuation">,</span> write_count<span class="token operator">=</span><span class="token number">46560</span><span class="token punctuation">,</span> read_bytes<span class="token operator">=</span><span class="token number">5038501376</span><span class="token punctuation">,</span> write_bytes<span class="token operator">=</span><span class="token number">408987648</span><span class="token punctuation">,</span> read_time<span class="token operator">=</span><span class="token number">77974</span><span class="token punctuation">,</span> write_time<span class="token operator">=</span><span class="token number">79557</span><span class="token punctuation">,</span> read_merged_count<span class="token operator">=</span><span class="token number">5933</span><span class="token punctuation">,</span> write_merged_count<span class="token operator">=</span><span class="token number">35916</span><span class="token punctuation">,</span> busy_time<span class="token operator">=</span><span class="token number">42153</span><span class="token punctuation">)</span>

In <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>disk_io_counters<span class="token punctuation">(</span>perdisk<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>                                      
Out<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
<span class="token punctuation">&#123;</span><span class="token string">'sda'</span><span class="token punctuation">:</span> sdiskio<span class="token punctuation">(</span>read_count<span class="token operator">=</span><span class="token number">41472</span><span class="token punctuation">,</span> write_count<span class="token operator">=</span><span class="token number">5340</span><span class="token punctuation">,</span> read_bytes<span class="token operator">=</span><span class="token number">2524417024</span><span class="token punctuation">,</span> write_bytes<span class="token operator">=</span><span class="token number">205662720</span><span class="token punctuation">,</span> read_time<span class="token operator">=</span><span class="token number">38302</span><span class="token punctuation">,</span> write_time<span class="token operator">=</span><span class="token number">4484</span><span class="token punctuation">,</span> read_merged_count<span class="token operator">=</span><span class="token number">5933</span><span class="token punctuation">,</span> write_merged_count<span class="token operator">=</span><span class="token number">35916</span><span class="token punctuation">,</span> busy_time<span class="token operator">=</span><span class="token number">21074</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token string">'sda1'</span><span class="token punctuation">:</span> sdiskio<span class="token punctuation">(</span>read_count<span class="token operator">=</span><span class="token number">1854</span><span class="token punctuation">,</span> write_count<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> read_bytes<span class="token operator">=</span><span class="token number">6441472</span><span class="token punctuation">,</span> write_bytes<span class="token operator">=</span><span class="token number">2097152</span><span class="token punctuation">,</span> read_time<span class="token operator">=</span><span class="token number">370</span><span class="token punctuation">,</span> write_time<span class="token operator">=</span><span class="token number">35</span><span class="token punctuation">,</span> read_merged_count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> write_merged_count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> busy_time<span class="token operator">=</span><span class="token number">396</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token string">'sda2'</span><span class="token punctuation">:</span> sdiskio<span class="token punctuation">(</span>read_count<span class="token operator">=</span><span class="token number">39587</span><span class="token punctuation">,</span> write_count<span class="token operator">=</span><span class="token number">5337</span><span class="token punctuation">,</span> read_bytes<span class="token operator">=</span><span class="token number">2516263424</span><span class="token punctuation">,</span> write_bytes<span class="token operator">=</span><span class="token number">203570688</span><span class="token punctuation">,</span> read_time<span class="token operator">=</span><span class="token number">37925</span><span class="token punctuation">,</span> write_time<span class="token operator">=</span><span class="token number">4449</span><span class="token punctuation">,</span> read_merged_count<span class="token operator">=</span><span class="token number">5933</span><span class="token punctuation">,</span> write_merged_count<span class="token operator">=</span><span class="token number">35916</span><span class="token punctuation">,</span> busy_time<span class="token operator">=</span><span class="token number">20675</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token string">'sr0'</span><span class="token punctuation">:</span> sdiskio<span class="token punctuation">(</span>read_count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> write_count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> read_bytes<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> write_bytes<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> read_time<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> write_time<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> read_merged_count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> write_merged_count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> busy_time<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token string">'dm-0'</span><span class="token punctuation">:</span> sdiskio<span class="token punctuation">(</span>read_count<span class="token operator">=</span><span class="token number">38566</span><span class="token punctuation">,</span> write_count<span class="token operator">=</span><span class="token number">5197</span><span class="token punctuation">,</span> read_bytes<span class="token operator">=</span><span class="token number">2483773952</span><span class="token punctuation">,</span> write_bytes<span class="token operator">=</span><span class="token number">55885312</span><span class="token punctuation">,</span> read_time<span class="token operator">=</span><span class="token number">37685</span><span class="token punctuation">,</span> write_time<span class="token operator">=</span><span class="token number">3546</span><span class="token punctuation">,</span> read_merged_count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> write_merged_count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> busy_time<span class="token operator">=</span><span class="token number">19410</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token string">'dm-1'</span><span class="token punctuation">:</span> sdiskio<span class="token punctuation">(</span>read_count<span class="token operator">=</span><span class="token number">6875</span><span class="token punctuation">,</span> write_count<span class="token operator">=</span><span class="token number">36059</span><span class="token punctuation">,</span> read_bytes<span class="token operator">=</span><span class="token number">30310400</span><span class="token punctuation">,</span> write_bytes<span class="token operator">=</span><span class="token number">147697664</span><span class="token punctuation">,</span> read_time<span class="token operator">=</span><span class="token number">1987</span><span class="token punctuation">,</span> write_time<span class="token operator">=</span><span class="token number">71537</span><span class="token punctuation">,</span> read_merged_count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> write_merged_count<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> busy_time<span class="token operator">=</span><span class="token number">1673</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="2）psutil-disk-partitions"><a href="#2）psutil-disk-partitions" class="headerlink" title="2）psutil.disk_partitions"></a>2）psutil.disk_partitions</h6><p>以命名元组的形式返回所有已挂载的磁盘，包含磁盘名称，挂载点，文件系统类型等信息。当all等于True时，返回包含&#x2F;proc等特殊文件系统的挂载信息。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>disk_partitions<span class="token punctuation">(</span><span class="token punctuation">)</span>                                                   
Out<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
<span class="token punctuation">[</span>sdiskpart<span class="token punctuation">(</span>device<span class="token operator">=</span><span class="token string">'/dev/mapper/centos-root'</span><span class="token punctuation">,</span> mountpoint<span class="token operator">=</span><span class="token string">'/'</span><span class="token punctuation">,</span> fstype<span class="token operator">=</span><span class="token string">'xfs'</span><span class="token punctuation">,</span> opts<span class="token operator">=</span><span class="token string">'rw,seclabel,relatime,attr2,inode64,noquota'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 sdiskpart<span class="token punctuation">(</span>device<span class="token operator">=</span><span class="token string">'/dev/sda1'</span><span class="token punctuation">,</span> mountpoint<span class="token operator">=</span><span class="token string">'/boot'</span><span class="token punctuation">,</span> fstype<span class="token operator">=</span><span class="token string">'xfs'</span><span class="token punctuation">,</span> opts<span class="token operator">=</span><span class="token string">'rw,seclabel,relatime,attr2,inode64,noquota'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

In <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>device <span class="token keyword">for</span> device <span class="token keyword">in</span> psutil<span class="token punctuation">.</span>disk_partitions<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> device<span class="token punctuation">.</span>mountpoint <span class="token operator">==</span> <span class="token string">'/'</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>sdiskpart<span class="token punctuation">(</span>device<span class="token operator">=</span><span class="token string">'/dev/mapper/centos-root'</span><span class="token punctuation">,</span> mountpoint<span class="token operator">=</span><span class="token string">'/'</span><span class="token punctuation">,</span> fstype<span class="token operator">=</span><span class="token string">'xfs'</span><span class="token punctuation">,</span> opts<span class="token operator">=</span><span class="token string">'rw,seclabel,relatime,attr2,inode64,noquota'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

In <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">def</span> <span class="token function">get_disk_via_mountpoint</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">:</span> 
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>     disk <span class="token operator">=</span> <span class="token punctuation">[</span>item <span class="token keyword">for</span> item <span class="token keyword">in</span> psutil<span class="token punctuation">.</span>disk_partitions<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> item<span class="token punctuation">.</span>mountpoint <span class="token operator">==</span> point<span class="token punctuation">]</span> 
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>     <span class="token keyword">return</span> disk<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>device 
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span>                             

In <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">:</span> get_disk_via_mountpoint<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
Out<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'/dev/mapper/centos-root'</span>

In <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">:</span> get_disk_via_mountpoint<span class="token punctuation">(</span><span class="token string">'/boot'</span><span class="token punctuation">)</span> 
Out<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'/dev/sda1'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="3）psutil-disk-usage"><a href="#3）psutil-disk-usage" class="headerlink" title="3）psutil.disk_usage"></a>3）psutil.disk_usage</h6><p>以命名元组的形式返回path所在磁盘的使用情况，包括磁盘的容量、已经使用的磁盘容量、磁盘的空间利用率等。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>disk_usage<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>       
Out<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">:</span> sdiskusage<span class="token punctuation">(</span>total<span class="token operator">=</span><span class="token number">18238930944</span><span class="token punctuation">,</span> used<span class="token operator">=</span><span class="token number">6775488512</span><span class="token punctuation">,</span> free<span class="token operator">=</span><span class="token number">11463442432</span><span class="token punctuation">,</span> percent<span class="token operator">=</span><span class="token number">37.1</span><span class="token punctuation">)</span>

In <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>disk_usage<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>percent
Out<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">37.2</span>

In <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token builtin">type</span><span class="token punctuation">(</span>psutil<span class="token punctuation">.</span>disk_usage<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>percent<span class="token punctuation">)</span>
Out<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token builtin">float</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="（4）网络"><a href="#（4）网络" class="headerlink" title="（4）网络"></a>（4）网络</h5><p>与网络相关的函数如下：</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>详情</th>
</tr>
</thead>
<tbody><tr>
<td>psutil.net_io_counter([pernic])</td>
<td>以命名元组的形式返回当前系统中每块网卡的网络io统计信息，包括收发字节数，收发包的数量、出错的情况和删包情况。当pernic为True时，则列出所有网卡的统计信息。</td>
</tr>
<tr>
<td>psutil.net_connections([kind])</td>
<td>以列表的形式返回每个网络连接的详细信息(namedtuple)。命名元组包含fd, family, type, laddr, raddr, status, pid等信息。kind表示过滤的连接类型，支持的值如下：(默认为inet)</td>
</tr>
<tr>
<td>psutil.net_if_addrs()</td>
<td>以字典的形式返回网卡的配置信息，包括IP地址和mac地址、子网掩码和广播地址。</td>
</tr>
<tr>
<td>psutil.net_if_stats()</td>
<td>返回网卡的详细信息，包括是否启动、通信类型、传输速度与mtu。</td>
</tr>
<tr>
<td>psutil.users()</td>
<td>以命名元组的方式返回当前登陆用户的信息，包括用户名，登陆时间，终端，与主机信息</td>
</tr>
<tr>
<td>psutil.boot_time()</td>
<td>以时间戳的形式返回系统的启动时间</td>
</tr>
</tbody></table>
<h6 id="1）psutil-net-io-counter"><a href="#1）psutil-net-io-counter" class="headerlink" title="1）psutil.net_io_counter"></a>1）psutil.net_io_counter</h6><p>以命名元组的形式返回当前系统中每块网卡的网络io统计信息，包括收发字节数，收发包的数量、出错的情况和删包情况。当pernic为True时，则列出所有网卡的统计信息。使用net_io_counter函数与自己解析&#x2F;proc&#x2F;net&#x2F;dev文件内容实现的功能相同。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">import</span> psutil                

In <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>net_io_counters<span class="token punctuation">(</span><span class="token punctuation">)</span>     
Out<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span> snetio<span class="token punctuation">(</span>bytes_sent<span class="token operator">=</span><span class="token number">720405</span><span class="token punctuation">,</span> bytes_recv<span class="token operator">=</span><span class="token number">3661606</span><span class="token punctuation">,</span> packets_sent<span class="token operator">=</span><span class="token number">5520</span><span class="token punctuation">,</span> packets_recv<span class="token operator">=</span><span class="token number">14886</span><span class="token punctuation">,</span> errin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> errout<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> dropin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> dropout<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

In <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>net_io_counters<span class="token punctuation">(</span>pernic<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> 
Out<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
<span class="token punctuation">&#123;</span><span class="token string">'ens37'</span><span class="token punctuation">:</span> snetio<span class="token punctuation">(</span>bytes_sent<span class="token operator">=</span><span class="token number">724145</span><span class="token punctuation">,</span> bytes_recv<span class="token operator">=</span><span class="token number">3365944</span><span class="token punctuation">,</span> packets_sent<span class="token operator">=</span><span class="token number">5538</span><span class="token punctuation">,</span> packets_recv<span class="token operator">=</span><span class="token number">10017</span><span class="token punctuation">,</span> errin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> errout<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> dropin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> dropout<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token string">'lo'</span><span class="token punctuation">:</span> snetio<span class="token punctuation">(</span>bytes_sent<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> bytes_recv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> packets_sent<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> packets_recv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> errin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> errout<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> dropin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> dropout<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token string">'virbr0-nic'</span><span class="token punctuation">:</span> snetio<span class="token punctuation">(</span>bytes_sent<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> bytes_recv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> packets_sent<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> packets_recv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> errin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> errout<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> dropin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> dropout<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token string">'virbr0'</span><span class="token punctuation">:</span> snetio<span class="token punctuation">(</span>bytes_sent<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> bytes_recv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> packets_sent<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> packets_recv<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> errin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> errout<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> dropin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> dropout<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token string">'ens33'</span><span class="token punctuation">:</span> snetio<span class="token punctuation">(</span>bytes_sent<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> bytes_recv<span class="token operator">=</span><span class="token number">298202</span><span class="token punctuation">,</span> packets_sent<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> packets_recv<span class="token operator">=</span><span class="token number">4899</span><span class="token punctuation">,</span> errin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> errout<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> dropin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> dropout<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="2）net-connections"><a href="#2）net-connections" class="headerlink" title="2）net_connections"></a>2）net_connections</h6><p>以列表的形式返回每个网络连接的详细信息(namedtuple)，可以使用该函数查看网络连接状态，统计连接个数以及处于特定状态的网络连接个数。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>net_connections<span class="token punctuation">(</span><span class="token punctuation">)</span>      
Out<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
<span class="token punctuation">[</span>sconn<span class="token punctuation">(</span>fd<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span> family<span class="token operator">=</span><span class="token operator">&lt;</span>AddressFamily<span class="token punctuation">.</span>AF_INET6<span class="token punctuation">:</span> <span class="token number">10</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token operator">&lt;</span>SocketKind<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">:</span> <span class="token number">1</span><span class="token operator">></span><span class="token punctuation">,</span> laddr<span class="token operator">=</span>addr<span class="token punctuation">(</span>ip<span class="token operator">=</span><span class="token string">'::'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">,</span> raddr<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> status<span class="token operator">=</span><span class="token string">'LISTEN'</span><span class="token punctuation">,</span> pid<span class="token operator">=</span><span class="token number">6558</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 sconn<span class="token punctuation">(</span>fd<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> family<span class="token operator">=</span><span class="token operator">&lt;</span>AddressFamily<span class="token punctuation">.</span>AF_INET6<span class="token punctuation">:</span> <span class="token number">10</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token operator">&lt;</span>SocketKind<span class="token punctuation">.</span>SOCK_DGRAM<span class="token punctuation">:</span> <span class="token number">2</span><span class="token operator">></span><span class="token punctuation">,</span> laddr<span class="token operator">=</span>addr<span class="token punctuation">(</span>ip<span class="token operator">=</span><span class="token string">'::'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">,</span> raddr<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> status<span class="token operator">=</span><span class="token string">'NONE'</span><span class="token punctuation">,</span> pid<span class="token operator">=</span><span class="token number">6558</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 sconn<span class="token punctuation">(</span>fd<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> family<span class="token operator">=</span><span class="token operator">&lt;</span>AddressFamily<span class="token punctuation">.</span>AF_INET6<span class="token punctuation">:</span> <span class="token number">10</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token operator">&lt;</span>SocketKind<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">:</span> <span class="token number">1</span><span class="token operator">></span><span class="token punctuation">,</span> laddr<span class="token operator">=</span>addr<span class="token punctuation">(</span>ip<span class="token operator">=</span><span class="token string">'::1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">6010</span><span class="token punctuation">)</span><span class="token punctuation">,</span> raddr<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> status<span class="token operator">=</span><span class="token string">'LISTEN'</span><span class="token punctuation">,</span> pid<span class="token operator">=</span><span class="token number">9047</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 sconn<span class="token punctuation">(</span>fd<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span> family<span class="token operator">=</span><span class="token operator">&lt;</span>AddressFamily<span class="token punctuation">.</span>AF_INET<span class="token punctuation">:</span> <span class="token number">2</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token operator">&lt;</span>SocketKind<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">:</span> <span class="token number">1</span><span class="token operator">></span><span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

In <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span> conns <span class="token operator">=</span> psutil<span class="token punctuation">.</span>net_connections<span class="token punctuation">(</span><span class="token punctuation">)</span>

In <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token punctuation">[</span>conn <span class="token keyword">for</span> conn <span class="token keyword">in</span> conns <span class="token keyword">if</span> conn<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token string">'TIME_WAIT'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>   
Out<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h6 id="3）net-if-addrs"><a href="#3）net-if-addrs" class="headerlink" title="3）net_if_addrs"></a>3）net_if_addrs</h6><p>以字典的形式返回网卡的配置信息，包括IP地址和mac地址、子网掩码和广播地址。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>net_if_addrs<span class="token punctuation">(</span><span class="token punctuation">)</span>                                                                                               
Out<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
<span class="token punctuation">&#123;</span><span class="token string">'lo'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>snicaddr<span class="token punctuation">(</span>family<span class="token operator">=</span><span class="token operator">&lt;</span>AddressFamily<span class="token punctuation">.</span>AF_INET<span class="token punctuation">:</span> <span class="token number">2</span><span class="token operator">></span><span class="token punctuation">,</span> address<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> netmask<span class="token operator">=</span><span class="token string">'255.0.0.0'</span><span class="token punctuation">,</span> broadcast<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> ptp<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  snicaddr<span class="token punctuation">(</span>family<span class="token operator">=</span><span class="token operator">&lt;</span>AddressFamily<span class="token punctuation">.</span>AF_INET6<span class="token punctuation">:</span> <span class="token number">10</span><span class="token operator">></span><span class="token punctuation">,</span> address<span class="token operator">=</span><span class="token string">'::1'</span><span class="token punctuation">,</span> netmask<span class="token operator">=</span><span class="token string">'ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff'</span><span class="token punctuation">,</span> broadcast<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> ptp<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  snicaddr<span class="token punctuation">(</span>family<span class="token operator">=</span><span class="token operator">&lt;</span>AddressFamily<span class="token punctuation">.</span>AF_PACKET<span class="token punctuation">:</span> <span class="token number">17</span><span class="token operator">></span><span class="token punctuation">,</span> address<span class="token operator">=</span><span class="token string">'00:00:00:00:00:00'</span><span class="token punctuation">,</span> netmask<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> broadcast<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> ptp<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token string">'ens37'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>snicaddr<span class="token punctuation">(</span>family<span class="token operator">=</span><span class="token operator">&lt;</span>AddressFamily<span class="token punctuation">.</span>AF_INET<span class="token punctuation">:</span> <span class="token number">2</span><span class="token operator">></span><span class="token punctuation">,</span> address<span class="token operator">=</span><span class="token string">'192.168.1.131'</span><span class="token punctuation">,</span> netmask<span class="token operator">=</span><span class="token string">'255.255.255.255'</span><span class="token punctuation">,</span> broadcast<span class="token operator">=</span><span class="token string">'192.168.1.131'</span><span class="token punctuation">,</span> ptp<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  snicaddr<span class="token punctuation">(</span>family<span class="token operator">=</span><span class="token operator">&lt;</span>AddressFamily<span class="token punctuation">.</span>AF_INET6<span class="token punctuation">:</span> <span class="token number">10</span><span class="token operator">></span><span class="token punctuation">,</span> address<span class="token operator">=</span><span class="token string">'240e:82:e03:7342:4378:7be3:558c:fc88'</span><span class="token punctuation">,</span> netmask<span class="token operator">=</span><span class="token string">'ffff:ffff:ffff:ffff::'</span><span class="token punctuation">,</span> broadcast<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> ptp<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="4）psutil-net-if-stats"><a href="#4）psutil-net-if-stats" class="headerlink" title="4）psutil.net_if_stats"></a>4）psutil.net_if_stats</h6><p>返回网卡的详细信息，包括是否启动、通信类型、传输速度与mtu。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>net_if_stats<span class="token punctuation">(</span><span class="token punctuation">)</span>        
Out<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
<span class="token punctuation">&#123;</span><span class="token string">'ens37'</span><span class="token punctuation">:</span> snicstats<span class="token punctuation">(</span>isup<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> duplex<span class="token operator">=</span><span class="token operator">&lt;</span>NicDuplex<span class="token punctuation">.</span>NIC_DUPLEX_FULL<span class="token punctuation">:</span> <span class="token number">2</span><span class="token operator">></span><span class="token punctuation">,</span> speed<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> mtu<span class="token operator">=</span><span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token string">'lo'</span><span class="token punctuation">:</span> snicstats<span class="token punctuation">(</span>isup<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> duplex<span class="token operator">=</span><span class="token operator">&lt;</span>NicDuplex<span class="token punctuation">.</span>NIC_DUPLEX_UNKNOWN<span class="token punctuation">:</span> <span class="token number">0</span><span class="token operator">></span><span class="token punctuation">,</span> speed<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> mtu<span class="token operator">=</span><span class="token number">65536</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token string">'virbr0-nic'</span><span class="token punctuation">:</span> snicstats<span class="token punctuation">(</span>isup<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> duplex<span class="token operator">=</span><span class="token operator">&lt;</span>NicDuplex<span class="token punctuation">.</span>NIC_DUPLEX_FULL<span class="token punctuation">:</span> <span class="token number">2</span><span class="token operator">></span><span class="token punctuation">,</span> speed<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> mtu<span class="token operator">=</span><span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token string">'virbr0'</span><span class="token punctuation">:</span> snicstats<span class="token punctuation">(</span>isup<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> duplex<span class="token operator">=</span><span class="token operator">&lt;</span>NicDuplex<span class="token punctuation">.</span>NIC_DUPLEX_UNKNOWN<span class="token punctuation">:</span> <span class="token number">0</span><span class="token operator">></span><span class="token punctuation">,</span> speed<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> mtu<span class="token operator">=</span><span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 <span class="token string">'ens33'</span><span class="token punctuation">:</span> snicstats<span class="token punctuation">(</span>isup<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> duplex<span class="token operator">=</span><span class="token operator">&lt;</span>NicDuplex<span class="token punctuation">.</span>NIC_DUPLEX_FULL<span class="token punctuation">:</span> <span class="token number">2</span><span class="token operator">></span><span class="token punctuation">,</span> speed<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">,</span> mtu<span class="token operator">=</span><span class="token number">1500</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="（5）其他"><a href="#（5）其他" class="headerlink" title="（5）其他"></a>（5）其他</h5><h6 id="1）users"><a href="#1）users" class="headerlink" title="1）users"></a>1）users</h6><p>以命名元组的方式返回当前登陆用户的信息，包括用户名，登陆时间，终端，与主机信息。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>users<span class="token punctuation">(</span><span class="token punctuation">)</span>              
Out<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">:</span> 
<span class="token punctuation">[</span>suser<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> terminal<span class="token operator">=</span><span class="token string">':0'</span><span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span> started<span class="token operator">=</span><span class="token number">1582366080.0</span><span class="token punctuation">,</span> pid<span class="token operator">=</span><span class="token number">7991</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 suser<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> terminal<span class="token operator">=</span><span class="token string">'pts/0'</span><span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span> started<span class="token operator">=</span><span class="token number">1582366208.0</span><span class="token punctuation">,</span> pid<span class="token operator">=</span><span class="token number">8927</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 suser<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> terminal<span class="token operator">=</span><span class="token string">'pts/1'</span><span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">'192.168.1.4'</span><span class="token punctuation">,</span> started<span class="token operator">=</span><span class="token number">1582370816.0</span><span class="token punctuation">,</span> pid<span class="token operator">=</span><span class="token number">10099</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
 suser<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> terminal<span class="token operator">=</span><span class="token string">'pts/3'</span><span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">'192.168.1.4'</span><span class="token punctuation">,</span> started<span class="token operator">=</span><span class="token number">1582369408.0</span><span class="token punctuation">,</span> pid<span class="token operator">=</span><span class="token number">9787</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="2）boot-time"><a href="#2）boot-time" class="headerlink" title="2）boot_time"></a>2）boot_time</h6><p>以时间戳的形式返回系统的启动时间。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>boot_time<span class="token punctuation">(</span><span class="token punctuation">)</span>    
Out<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">1582527367.0</span>
    
In <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>fromtimestamp<span class="token punctuation">(</span>psutil<span class="token punctuation">.</span>boot_time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span>                                  
Out<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'2020-02-24 14:56:07'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="3、综合案例：使用psutil实现监控程序"><a href="#3、综合案例：使用psutil实现监控程序" class="headerlink" title="3、综合案例：使用psutil实现监控程序"></a>3、综合案例：使用psutil实现监控程序</h4><h4 id="4、psutil进程管理"><a href="#4、psutil进程管理" class="headerlink" title="4、psutil进程管理"></a>4、psutil进程管理</h4><p>psutil还提供了作为进程管理的功能函数，包括获取进程列表，判断是否存在，以及进程管理的类封装。</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>详情</th>
</tr>
</thead>
<tbody><tr>
<td>psutil.Process()</td>
<td>对进程进行封装，可以使用该类的方法获取进行的详细信息，或者给进程发送信号。</td>
</tr>
<tr>
<td>psutil.pids()</td>
<td>以列表的形式返回当前正在运行的进程</td>
</tr>
<tr>
<td>psutil.pid_exists(1)</td>
<td>判断给点定的pid是否存在</td>
</tr>
<tr>
<td>psutil.process_iter()</td>
<td>迭代当前正在运行的进程，返回的是每个进程的Process对象</td>
</tr>
</tbody></table>
<h6 id="1）Process类"><a href="#1）Process类" class="headerlink" title="1）Process类"></a>1）Process类</h6><p>对进程进行封装，可以使用该类的方法获取进行的详细信息，或者给进程发送信号。  </p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">import</span> psutil                 

In <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span> init_process <span class="token operator">=</span> psutil<span class="token punctuation">.</span>Process<span class="token punctuation">(</span><span class="token punctuation">)</span>

In <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span> init_process<span class="token punctuation">.</span>cmdline<span class="token punctuation">(</span><span class="token punctuation">)</span>      
Out<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'/usr/local/python38/bin/python3.8'</span><span class="token punctuation">,</span> <span class="token string">'/usr/local/python38/bin/ipython'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Process类包含很多方法来获取进程的详细信息。下面是几个较常用的方法：</p>
<pre class="line-numbers language-tex" data-language="tex"><code class="language-tex">name：获取进程的名称
cmdline：获取启动进程的命令行参数
create_time：获取进程的创建时间(时间戳格式)
num_fds：进程打开的文件个数
num_threads：进程的子进程个数
is_running：判断进程是否正在运行
send_signal：给进程发送信号，类似与os.kill等
kill：发送SIGKILL信号结束进程
terminate：发送SIGTEAM信号结束进程<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="2）pids"><a href="#2）pids" class="headerlink" title="2）pids"></a>2）pids</h6><p>以列表的形式返回当前正在运行的进程。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">import</span> psutil                 

In <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span> init_process <span class="token operator">=</span> psutil<span class="token punctuation">.</span>Process<span class="token punctuation">(</span><span class="token punctuation">)</span>

In <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span> init_process<span class="token punctuation">.</span>cmdline<span class="token punctuation">(</span><span class="token punctuation">)</span>       
Out<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'/usr/local/python38/bin/python3.8'</span><span class="token punctuation">,</span> <span class="token string">'/usr/local/python38/bin/ipython'</span><span class="token punctuation">]</span>

In <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>pids<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span>            
Out<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="3）pid-exists"><a href="#3）pid-exists" class="headerlink" title="3）pid_exists"></a>3）pid_exists</h6><p>判断给点定的pid是否存在。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>pid_exists<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>          
Out<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean">True</span>

In <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>pid_exists<span class="token punctuation">(</span><span class="token number">10245</span><span class="token punctuation">)</span>                              
Out<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="4）process-iter"><a href="#4）process-iter" class="headerlink" title="4）process_iter"></a>4）process_iter</h6><p>迭代当前正在运行的进程，返回的是每个进程的Process对象，而pids返回的是进程的列表。</p>
<h3 id="四、使用Python监控MongoDB"><a href="#四、使用Python监控MongoDB" class="headerlink" title="四、使用Python监控MongoDB"></a>四、使用Python监控MongoDB</h3><p>对于MongoDB数据库来说，获取监控的方法比较简单，因为MongoDB本身流返回给我们一个字典形式的数据。如下所示：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">pip install <span class="token operator">-</span>i https<span class="token punctuation">:</span><span class="token operator">//</span>pypi<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>simple pymongo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#/usr/bin/python</span>
<span class="token comment">#_*_ coding:utf-8 _*_</span>

<span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function
<span class="token keyword">import</span> pymongo


client <span class="token operator">=</span> pymongo<span class="token punctuation">.</span>MongoClient<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1:27017'</span><span class="token punctuation">)</span>
client<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>authenticate<span class="token punctuation">(</span><span class="token string">'laoyu'</span><span class="token punctuation">,</span><span class="token string">'laoyu'</span><span class="token punctuation">)</span>
rs <span class="token operator">=</span> client<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>command<span class="token punctuation">(</span><span class="token string">'replSetGetStatus'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"set:"</span><span class="token punctuation">,</span>rs<span class="token punctuation">[</span><span class="token string">'set'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"myState:"</span><span class="token punctuation">,</span>rs<span class="token punctuation">[</span><span class="token string">'myState'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'num of members:'</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>rs<span class="token punctuation">[</span><span class="token string">'members'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h6 id="3）pid-exists-1"><a href="#3）pid-exists-1" class="headerlink" title="3）pid_exists"></a>3）pid_exists</h6><p>判断给点定的pid是否存在。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>pid_exists<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>          
Out<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean">True</span>

In <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">:</span> psutil<span class="token punctuation">.</span>pid_exists<span class="token punctuation">(</span><span class="token number">10245</span><span class="token punctuation">)</span>                              
Out<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h6 id="4）process-iter-1"><a href="#4）process-iter-1" class="headerlink" title="4）process_iter"></a>4）process_iter</h6><p>迭代当前正在运行的进程，返回的是每个进程的Process对象，而pids返回的是进程的列表。</p>
<h3 id="四、使用Python监控MongoDB-1"><a href="#四、使用Python监控MongoDB-1" class="headerlink" title="四、使用Python监控MongoDB"></a>四、使用Python监控MongoDB</h3><p>对于MongoDB数据库来说，获取监控的方法比较简单，因为MongoDB本身流返回给我们一个字典形式的数据。如下所示：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">pip install <span class="token operator">-</span>i https<span class="token punctuation">:</span><span class="token operator">//</span>pypi<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>simple pymongo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#/usr/bin/python</span>
<span class="token comment">#_*_ coding:utf-8 _*_</span>

<span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function
<span class="token keyword">import</span> pymongo


client <span class="token operator">=</span> pymongo<span class="token punctuation">.</span>MongoClient<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1:27017'</span><span class="token punctuation">)</span>
client<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>authenticate<span class="token punctuation">(</span><span class="token string">'laoyu'</span><span class="token punctuation">,</span><span class="token string">'laoyu'</span><span class="token punctuation">)</span>
rs <span class="token operator">=</span> client<span class="token punctuation">.</span>admin<span class="token punctuation">.</span>command<span class="token punctuation">(</span><span class="token string">'replSetGetStatus'</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"set:"</span><span class="token punctuation">,</span>rs<span class="token punctuation">[</span><span class="token string">'set'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"myState:"</span><span class="token punctuation">,</span>rs<span class="token punctuation">[</span><span class="token string">'myState'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'num of members:'</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>rs<span class="token punctuation">[</span><span class="token string">'members'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>




                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Echo</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://pdxblog.top/post/2903dcc5.html">https://pdxblog.top/post/2903dcc5.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Echo</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Python/">
                                    <span class="chip bg-color">Python</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,CSDN,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/post/cde52c78.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/4.jpg" class="responsive-img" alt="Python网络管理">
                        
                        <span class="card-title">Python网络管理</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2020-05-15
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Python/" class="post-category">
                                    Python
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Python/">
                        <span class="chip bg-color">Python</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/post/c29cb5f8.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/15.jpg" class="responsive-img" alt="Python3+Django3开发简单的人员管理系统">
                        
                        <span class="card-title">Python3+Django3开发简单的人员管理系统</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-04-27
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Python/" class="post-category">
                                    Python
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Python/">
                        <span class="chip bg-color">Python</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: Echo’s blog<br />'
            + '文章作者: Echo<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2022</span>
            
            <a href="/about" target="_blank">Echo</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2019";
                        var startMonth = "6";
                        var startDate = "28";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/Gilbert2/echo.github.io" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:maisy0316@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2960824193" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2960824193" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
