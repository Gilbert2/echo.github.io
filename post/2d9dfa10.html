<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Python生态工具, Echo’s blog">
    <meta name="description" content="Python生态工具一、Python内置小工具1.1、 1秒钟启动一个下载服务器在实际工作中，时常会有这样的一个需求：将文件传给其他同事。将文件传给同事本身并不是一个很繁 琐的工作，现在的聊天工具一般都支持文件传输。但是，如果需要传送的文件">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Python生态工具 | Echo’s blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.1.0"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Echo’s blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Echo’s blog</div>
        <div class="logo-desc">
            
            人的一生就是一个储蓄的过程，在奋斗的时候储存了希望；在耕耘的时候储存了一粒种子；在旅行的时候储存了风景；在微笑的时候储存了快乐。聪明的人善于储蓄，在漫长而短暂的人生旅途中，学会储蓄每一个闪光的瞬间，然后用它们酿成一杯美好的回忆，在四季的变幻与交替之间，散发浓香，珍藏一生
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/Gilbert2/echo.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/Gilbert2/echo.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/8.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Python生态工具</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Python/">
                                <span class="chip bg-color">Python</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Python/" class="post-category">
                                Python
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-04-27
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="Python生态工具"><a href="#Python生态工具" class="headerlink" title="Python生态工具"></a>Python生态工具</h2><h3 id="一、Python内置小工具"><a href="#一、Python内置小工具" class="headerlink" title="一、Python内置小工具"></a>一、Python内置小工具</h3><h4 id="1-1、-1秒钟启动一个下载服务器"><a href="#1-1、-1秒钟启动一个下载服务器" class="headerlink" title="1.1、 1秒钟启动一个下载服务器"></a>1.1、 1秒钟启动一个下载服务器</h4><p>在实际工作中，时常会有这样的一个需求：将文件传给其他同事。将文件传给同事本身并不是一个很繁 琐的工作，现在的聊天工具一般都支持文件传输。但是，如果需要传送的文件较多，操作起来就会比较 麻烦。此外，如果文件在远程的服务器上，则需要先将远程服务器的文件下载到本地，然后再通过聊天 工具传给同事。再或者，你并不是特别清楚要传哪几个文件给同事，所以，你们需要进行交流，而交流 的时间成本是比较高的，会降低办事效率。</p>
<p>此时，如果你知道Python内置了一个下载服务器就能够显著提升效率了。例如，你的同事要让你传的文 件位于某一个目录下，那么，你可以进入这个目录，然后执行下面的命令启动一个下载服务器：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python -m SimpleHTTPServer <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>在Python 3中，由于对系统库进行了重新整理，因此，使用方式会有不同：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python -m http.server <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>执行上面的命令就会在当前目录下启动一个文件下载服务器，默认打开8000端口。完成以后，只需要将 IP和端口告诉同事，让同事自己去操作即可，非常方便高效。</p>
<p>使用浏览器访问Python启动的下载服务器，可以看到一个类似于FTP下载的界面，这个时候单击文件下 载即可。通过这种方式传输文件，可以降低大家的沟通成本，提高文件传输的效率。</p>
<p>上面使用的Python语句，从工作原理来说，仅仅是启动了一个Python内置的Web服务器。如果当前目 录下存在一个名为index.html的文件，则默认显示该文件的内容。如果当前目录下不存在这样一个文 件，则默认显示当前目录下的文件列表，也就是大家看到的下载服务器。 </p>
<h4 id="1-2、字符串转换为JSON"><a href="#1-2、字符串转换为JSON" class="headerlink" title="1.2、字符串转换为JSON"></a>1.2、字符串转换为JSON</h4><p>JSON是一种轻量级的数据交换格式，易于人类阅读和编写，同时也易于机器解析和生成。由于JSON的 诸多优点，已被广泛使用在各个系统中。JSON使用越广泛，需要将JSON字符串转换为JSON对象的需求 就越频繁。</p>
<p>例如，在工作过程中，我们的系统会调用底层服务的API。底层服务的API一般都是以JSON的格式返 回，为了便于问题追踪，我们会将API返回的JSON转换为字符串记录到日志文件中。当需要分析问题 时，就需要将日志文件中的JSON字符串拿出来进行分析。这个时候，需要将一个JSON字符串转换为 JSON对象，以提高日志的可读性。</p>
<p>这个需求十分常见，以至于使用搜索引擎搜索”JSON”，处于搜索结果的第一项便是“在线JSON格式化工 具”。除了打开浏览器，使用在线JSON格式化工具以外，我们也可以使用命令行终端的Python解释器来 解析JSON串，如下所示</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@oracle ~<span class="token punctuation">]</span><span class="token comment"># echo '&#123;"address": &#123;"province": "zhejiang", "city": "hangzhou"&#125;, "name": "lmx", "sex": "male"&#125;' | python -m json.tool </span>
<span class="token punctuation">&#123;</span>
   <span class="token string">"address"</span><span class="token builtin class-name">:</span> 
        <span class="token string">"city"</span><span class="token builtin class-name">:</span> <span class="token string">"hangzhou"</span>,
       <span class="token string">"province"</span><span class="token builtin class-name">:</span> <span class="token string">"zhejiang
   &#125;,
   "</span>name<span class="token string">": "</span>lmx<span class="token string">"
   "</span>sex<span class="token string">": "</span>male"
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>使用命令行解释器解析JSON串非常方便，而且，为了便于阅读，该工具还会自动将转换的结果进行对 齐和格式化。如下所示：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@oracle ~<span class="token punctuation">]</span><span class="token comment"># echo '&#123;"address": &#123;"province": "zhejiang", "city":</span>
<span class="token string">"hangzhou"</span><span class="token punctuation">&#125;</span>, <span class="token string">"name"</span><span class="token builtin class-name">:</span> <span class="token string">"lmx"</span>, <span class="token string">"sex"</span><span class="token builtin class-name">:</span> <span class="token string">"male"</span><span class="token punctuation">&#125;</span>' <span class="token operator">|</span> python -m json.tool
<span class="token punctuation">&#123;</span>
	<span class="token string">"address"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>
		<span class="token string">"city"</span><span class="token builtin class-name">:</span> <span class="token string">"hangzhou"</span>,
		<span class="token string">"province"</span><span class="token builtin class-name">:</span> <span class="token string">"zhejiang"</span>
	<span class="token punctuation">&#125;</span>,
	<span class="token string">"name"</span><span class="token builtin class-name">:</span> <span class="token string">"lmx"</span>,
	<span class="token string">"sex"</span><span class="token builtin class-name">:</span> <span class="token string">"male"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="1-3、检查第三方库是否正常安装"><a href="#1-3、检查第三方库是否正常安装" class="headerlink" title="1.3、检查第三方库是否正常安装"></a>1.3、检查第三方库是否正常安装</h4><p>安装完Python的第三方库以后，如何确认这个库已经正确安装了呢？答案很简单，只需要尝试进行 import导入即可。如果导入没有任何错误，则认为安装成功；如果导入失败，则认为安装失败。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span>root@oracle <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># python</span>
Python <span class="token number">2.7</span><span class="token number">.5</span> <span class="token punctuation">(</span>default<span class="token punctuation">,</span> Oct <span class="token number">30</span> <span class="token number">2018</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">45</span><span class="token punctuation">:</span><span class="token number">53</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>GCC <span class="token number">4.8</span><span class="token number">.5</span> <span class="token number">20150623</span> <span class="token punctuation">(</span>Red Hat <span class="token number">4.8</span><span class="token number">.5</span><span class="token operator">-</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">]</span> on linux2
Type <span class="token string">"help"</span><span class="token punctuation">,</span> <span class="token string">"copyright"</span><span class="token punctuation">,</span> <span class="token string">"credits"</span> <span class="token keyword">or</span> <span class="token string">"license"</span> <span class="token keyword">for</span> more information<span class="token punctuation">.</span>
<span class="token operator">>></span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>验证Python的第三方库是否安装成功，本身也是一件很简单的事情，但是，如果我们使用脚本对大批量 的服务器进行自动部署，又应该如何验证第三方库安装成功了呢？肯定不能登录每一台服务器进行验 证。这个时候，我们可以使用Python解释器的-c参数快速地执行import语句，如下所示：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@oracle ~<span class="token punctuation">]</span><span class="token comment"># python -c "import paramiko"</span>
Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span>:
File <span class="token string">"&lt;string>"</span>, line <span class="token number">1</span>, <span class="token keyword">in</span> <span class="token operator">&lt;</span>module<span class="token operator">></span>
ImportError: No module named paramiko<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="二、pip高级用法"><a href="#二、pip高级用法" class="headerlink" title="二、pip高级用法"></a>二、pip高级用法</h3><p>为了便于用户安装和管理第三方库和软件，越来越多的编程语言拥有自己的包管理工具，如nodejs的 npm，ruby的gem。Python也不例外，现在Python生态主流的包管理工具是pip</p>
<h4 id="2-1、pip介绍"><a href="#2-1、pip介绍" class="headerlink" title="2.1、pip介绍"></a>2.1、pip介绍</h4><p>pip是一个用来安装和管理Python包的工具，是easy_install的替代品，如果读者使用的是Python 2.7.9+或Python 3.4+版本的Python，则已经内置了pip，无须安装直接使用即可。如果系统中没有安装 pip，也可以手动安装</p>
<h4 id="2-2、python3安装pip"><a href="#2-2、python3安装pip" class="headerlink" title="2.2、python3安装pip"></a>2.2、python3安装pip</h4><blockquote>
<p><strong>方法1：python33安装完成后默认已经带有pip3</strong></p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@oracle bin<span class="token punctuation">]</span><span class="token comment"># pip3 -V</span>
pip <span class="token number">19.2</span>.3 from /usr/local/python38/lib/python3.8/site-packages/pip <span class="token punctuation">(</span>python
<span class="token number">3.8</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>root@oracle bin<span class="token punctuation">]</span><span class="token comment"># pwd</span>
/usr/local/python38/bin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>你可以用以下命令,创建软链接</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ln</span> -s /usr/local/python38/bin/pip3 /usr/bin/pip3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p><strong>方法2：使用以下方法重新安装pip插件</strong></p>
</blockquote>
<p>下载get-pip.py脚本</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> https://bootstrap.pypa.io/3.2/get-pip.py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>运行脚本</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python3 get-pip.py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>python3创建pip3索引</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ln</span> -s /usr/python3.6.1/bin/pip /usr/bin/pip3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>测试是否安装成功</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pip3 <span class="token function">install</span> requests<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>pip之所以能够成为最流行的包管理工具，并不是因为它被Python官方作为默认的包管理器，而是因为 它自身的诸多优点。pip的优点有：</p>
<pre class="line-numbers language-tex" data-language="tex"><code class="language-tex">pip提供了丰富的功能，其竞争对手easy_install则只支持安装，没有提供卸载和显示已安装列表的功
能；
pip能够很好地支持虚拟环境；
pip可以通过requirements.txt集中管理依赖；
pip能够处理二进制格式(.whl)；
pip是先下载后安装，如果安装失败，也会清理干净，不会留下一个中间状态。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果用户没有将软件打包上传到pypi.python.org，则无法使用pip进行安装。对于这种情况，Python生 态也有标准的做法，例如，我们尝试从源码安装paramiko。需要注意的是，我们也可以通过pip安装 paramiko的，这里只是为了演示Python生态中源码安装：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">git</span> clone https://github.com/paramiko/paramiko.git
$ <span class="token builtin class-name">cd</span> paramiko
$ python setup.py <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h4 id="2-3、给pip3重命名"><a href="#2-3、给pip3重命名" class="headerlink" title="2.3、给pip3重命名"></a>2.3、给pip3重命名</h4><p>切换至家目录，通过.bashrc添加别名</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@oracle bin<span class="token punctuation">]</span><span class="token comment"># cd ~</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># vim .bashrc</span>
<span class="token builtin class-name">alias</span> <span class="token assign-left variable">pip</span><span class="token operator">=</span>pip3
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># source .bashrc</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pip -V</span>
pip <span class="token number">19.2</span>.3 from /usr/local/python38/lib/python3.8/site-packages/pip <span class="token punctuation">(</span>python
<span class="token number">3.8</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="2-4、pip3常用命令"><a href="#2-4、pip3常用命令" class="headerlink" title="2.4、pip3常用命令"></a>2.4、pip3常用命令</h4><table>
<thead>
<tr>
<th>子命令</th>
<th>解释说明</th>
</tr>
</thead>
<tbody><tr>
<td>install</td>
<td>安装软件包</td>
</tr>
<tr>
<td>download</td>
<td>下载软件包</td>
</tr>
<tr>
<td>uninstall</td>
<td>卸载安装包</td>
</tr>
<tr>
<td>freeze</td>
<td>按照requirements格式输出安装包，可以到其他服务器上执行pip install -r requirements.txt直接安装软件</td>
</tr>
<tr>
<td>list</td>
<td>列出当前系统中的安装包</td>
</tr>
<tr>
<td>show</td>
<td>查看安装包的信息，包括版本、依赖、许可证、作者、主页等信息</td>
</tr>
<tr>
<td>check</td>
<td>检查安装包依赖是否完整</td>
</tr>
<tr>
<td>search</td>
<td>查找安装包</td>
</tr>
<tr>
<td>wheel</td>
<td>打包软件到wheel格式</td>
</tr>
<tr>
<td>hash</td>
<td>计算安装包的hash值</td>
</tr>
<tr>
<td>completion</td>
<td>生成命令补全配置</td>
</tr>
<tr>
<td>help</td>
<td>获取pip和子命令的帮助信息</td>
</tr>
</tbody></table>
<h4 id="2-5、加速pip安装的技巧"><a href="#2-5、加速pip安装的技巧" class="headerlink" title="2.5、加速pip安装的技巧"></a>2.5、加速pip安装的技巧</h4><p>如果大家使用Python的时间比较长的话，会发现Python安装的一个问题，即pypi.python.org不是特别 稳定，有时候会很慢，甚至处于完全不可用的状态。这个问题有什么好办法可以解决呢？根据笔者的经 验，至少有两种不同的方法。</p>
<h5 id="1、使用豆瓣或阿里云的源加速软件安装"><a href="#1、使用豆瓣或阿里云的源加速软件安装" class="headerlink" title="1、使用豆瓣或阿里云的源加速软件安装"></a>1、使用豆瓣或阿里云的源加速软件安装</h5><p>访问pypi.python.org不稳定的主要原因是因为网络不稳定，如果我们从网络稳定的服务器下载安装 包，问题就迎刃而解了。我们国内目前有多个pypi镜像，推荐使用豆瓣的镜像源或阿里的镜像源。如果 要使用第三方的源，只需要在安装时，通过pip命令的-i选项指定镜像源即可。如下所示：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pip <span class="token function">install</span> -i https://pypi.douban.com/simple/ flask<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>每次都要指定镜像源的地址比较麻烦，我们也可以修改pip的配置文件，将镜像源写入配置文件中。对 于Linux系统来说，需要创建～&#x2F;.pip&#x2F;pip.conf文件，然后在文件中保存如下内容：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># mkdir .pip</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cd .pip</span>
<span class="token punctuation">[</span>root@localhost .pip<span class="token punctuation">]</span><span class="token comment"># touch pip.conf</span>
<span class="token punctuation">[</span>root@localhost .pip<span class="token punctuation">]</span><span class="token comment"># vim pip.conf</span>
<span class="token punctuation">[</span>global<span class="token punctuation">]</span>
index-url <span class="token operator">=</span> https://pypi.douban.com/simple/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="2、将软件下载到本地部署"><a href="#2、将软件下载到本地部署" class="headerlink" title="2、将软件下载到本地部署"></a>2、将软件下载到本地部署</h5><p>如果需要对大批量的服务器安装软件包，并且安装包比较多或者比较大，则可以考虑将软件包下载到本 地，然后从本地安装。这对于使用脚本部署大量的服务器非常有用，此外，对于服务器无法连接外网的 情况，也可以使用这种方法。如下所示：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 下载到本地</span>
pip <span class="token function">install</span> --download<span class="token operator">=</span><span class="token string">'pwd'</span> -r requirements.txt

<span class="token comment"># 本地安装</span>
pip <span class="token function">install</span> --no-index -f file://<span class="token string">'pwd'</span> -r requirements.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>使用这种方式，只需要下载一次，就可以多处安装，不用担心网络不稳定的问题。并且，pip能够自动 处理软件依赖问题。例如，我们通过这种方式下载Flask到当前目录下，则Flask的依赖click、 itsdangerous、Jinja2、MarkupSafe和Werkzeug也会被下载到本地，如下所示：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pip <span class="token function">install</span> --download<span class="token operator">=</span><span class="token string">'pwd'</span> flask

$ <span class="token function">ls</span>
click-6.7-py2.py3-none-any.whl itsdangerous-0.24.tar.gz
MarkupSafe-0.23.tar.gz Flask-0.12-py2.py3-none-any.whl
Jinja2-2.9.5-py2.py3-none-any.whl Werkzeug-0.11.15-py2.py3-none-any.whl<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="三、Python变成辅助工具"><a href="#三、Python变成辅助工具" class="headerlink" title="三、Python变成辅助工具"></a>三、Python变成辅助工具</h3><p>因为Python是一门动态类型语言，所以，Python程序不需要编译和链接就可以直接运行。Python程序 运行时是从上至下逐行执行，因此Python工程师可以进行交互式的编程，从而快速验证代码的运行结果 是否符合预期。同时，Python工程师也可以通过交互式编程的方式学习Python编程。也正是因为 Python交互式编程的诸多优点，所以，Python交互式编程使用非常广泛。</p>
<h4 id="3-1、Python交互式编程"><a href="#3-1、Python交互式编程" class="headerlink" title="3.1、Python交互式编程"></a>3.1、Python交互式编程</h4><p>要使用Python的交互式编程，最简单的方式是使用标准的Python Shell。在命令行直接输入python命 令便可进入Python Shell，如下所示：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span>root@localhost <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># python</span>
Python <span class="token number">3.8</span><span class="token number">.1</span> <span class="token punctuation">(</span>default<span class="token punctuation">,</span> Jan <span class="token number">14</span> <span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token number">36</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>GCC <span class="token number">4.8</span><span class="token number">.5</span> <span class="token number">20150623</span> <span class="token punctuation">(</span>Red Hat <span class="token number">4.8</span><span class="token number">.5</span><span class="token operator">-</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">]</span> on linux
Type <span class="token string">"help"</span><span class="token punctuation">,</span> <span class="token string">"copyright"</span><span class="token punctuation">,</span> <span class="token string">"credits"</span> <span class="token keyword">or</span> <span class="token string">"license"</span> <span class="token keyword">for</span> more information<span class="token punctuation">.</span>
<span class="token operator">>></span><span class="token operator">></span> a<span class="token operator">=</span><span class="token number">3</span>
<span class="token operator">>></span><span class="token operator">></span> b<span class="token operator">=</span><span class="token number">4</span>
<span class="token operator">>></span><span class="token operator">></span> a<span class="token operator">+</span>b
<span class="token number">7</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>虽然标准的Python Shell也支持交互式编程，但是，它有很多不足，包括：</p>
<pre class="line-numbers language-tex" data-language="tex"><code class="language-tex">没有语法高亮；
不支持Tab自动补全；
没有自动缩进功能；
不能保存历史记录；
不能很好地与操作系统交互；
无法导入外部文件中的程序。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>虽然Python自带的交互式编程满足了功能性需求，但是在易用性上仍有诸多不足。IPython是增强型的 Python Shell，不但解决了上面提到的各种问题，而且提供了非常丰富的组件，可以方便地进行交互式 编程和数据分析。IPython功能丰富，不可避免地导致软件变得庞大复杂，因此，IPython 4.0对 IPython进行了拆分，分离成IPython Shell和jupyter两个组件，这两个组件现在需要分别安装。 按照行业惯例，IPython代指IPython Shell，是一个类似于Python Shell的交互式解释器；jupyter代指 IPython Notebook，是一个带图形界面的应用程序。接下来我们分别介绍IPython和jupyter的使用。</p>
<h4 id="3-2、使用IPython交互编程"><a href="#3-2、使用IPython交互编程" class="headerlink" title="3.2、使用IPython交互编程"></a>3.2、使用IPython交互编程</h4><p>IPython是一个第三方工具，因此，在使用之前需要先安装。可以直接使用操作系统的包管理工具或pip 进行安装。以下是在centos7上的安装方式：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pip install ipython</span>
Looking <span class="token keyword">in</span> indexes: https://pypi.douban.com/simple/
Collecting ipython
	Downloading
https://pypi.doubanio.com/packages/1c/f3/c8be38ee117d02508bb8b9158eb41ca416
f442a6e8e3b3159c2f2d14ed79/ipython-7.11.1-py3-none-any.whl <span class="token punctuation">(</span>777kB<span class="token punctuation">)</span>
	<span class="token operator">|</span>████████████████████████████████<span class="token operator">|</span> 778kB 934kB/s

……省略部分输出信息

Installing collected packages: six, ipython-genutils, decorator, traitlets,
ptyprocess, pexpect, pickleshare, wcwidth, prompt-toolkit, pygments,
backcall, parso, jedi, ipython
	Running setup.py <span class="token function">install</span> <span class="token keyword">for</span> backcall <span class="token punctuation">..</span>. <span class="token keyword">done</span>
Successfully installed backcall-0.1.0 decorator-4.4.1 ipython-7.11.1
ipython-genutils-0.2.0 jedi-0.15.2 parso-0.5.2 pexpect-4.7.0 pickleshare0.7.5 prompt-toolkit-3.0.2 ptyprocess-0.6.0 pygments-2.5.2 six-1.13.0
traitlets-4.3.3 wcwidth-0.1.8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>安装完成以后，在命令行终端输入ipython就进入了IPython交互式编程界面：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span>root@localhost <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># ipython</span>
Python <span class="token number">3.8</span><span class="token number">.1</span> <span class="token punctuation">(</span>default<span class="token punctuation">,</span> Jan <span class="token number">14</span> <span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token number">36</span><span class="token punctuation">)</span>
Type <span class="token string">'copyright'</span><span class="token punctuation">,</span> <span class="token string">'credits'</span> <span class="token keyword">or</span> <span class="token string">'license'</span> <span class="token keyword">for</span> more information
IPython <span class="token number">7.11</span><span class="token number">.1</span> <span class="token operator">-</span><span class="token operator">-</span> An enhanced Interactive Python<span class="token punctuation">.</span> Type <span class="token string">'?'</span> <span class="token keyword">for</span> <span class="token builtin">help</span><span class="token punctuation">.</span>

In <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token builtin">sum</span><span class="token operator">=</span><span class="token number">0</span>

In <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span> <span class="token builtin">sum</span><span class="token operator">+=</span>i
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">)</span>
<span class="token number">10</span>

In <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">import</span> os

In <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span> os<span class="token punctuation">.</span>getlogin<span class="token punctuation">(</span><span class="token punctuation">)</span>

Out<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'root'</span>

In <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>与标准的Python Shell一样，IPython的行显示了所使用的Python解释器版本以及当前的时间。第二行 是获取版权信息的方式，接着给出了IPython的版本。后是简短的使用说明，包括特征介绍、简短的 使用手册和如何获取帮助信息。表2-2给出了IPython提供的使用说明。 接下来我们将从五个不同的维度介绍IPython的使用，分别是：</p>
<blockquote>
<p>①更好的编辑器；</p>
<p>②更方便地获取帮助信息；</p>
<p>③IPython提供的magic函数； </p>
<p>④IPython的保存历史功能； </p>
<p>⑤IPython与操作系统交</p>
</blockquote>
<h5 id="（1）更好的编辑器"><a href="#（1）更好的编辑器" class="headerlink" title="（1）更好的编辑器"></a>（1）更好的编辑器</h5><p>IPython非常强大，有各种高级功能。其中，有用也直观的便是作为交互式编程工具的编辑器功 能。简单来说，IPython相对于标准的Python Shell是一个更好的交互式编程的编辑器，因为它具有：</p>
<pre class="line-numbers language-tex" data-language="tex"><code class="language-tex">语法高亮； 
自动缩进； 
Tab补全； 
快速获取帮助信息； 
搜索历史； 
执行shell命令<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果只是描述IPython的特征，相信读者并没有完全的概念。这个时候可以坐在计算机旁，打开IPython 随便敲几行Python代码和标准的Python Shell进行比较，就能够直观感受到IPython的优点。</p>
<p>IPython与标准Python Shell的大区别在于，IPython会对命令提示符的每一行进行编号，编号以后能 够提高交互式编程的可读性。更重要的是，我们可以通过IPython提供的特殊函数对编号以后的代码进 行操作。此外，IPython支持语法高亮和自动缩进，相对于标准的Python Shell，是一个更好的编辑 器。如果在编写代码的过错中出现了错误需要删除时，标准的Python Shell无法进行很好的处理，只能 重新进行输入，而IPython则不存在这样的问题。</p>
<p>tab补全是一个特别有用的功能，IPython支持tab补全，而标准的Python Shell不支持。大家可以想象 一下，一个工程师近正在学习Python，他知道一个库里面有他想要的函数，但是，他并不能非常准确 地说出这个函数的名称。这个时候，如果没有tab补全，就只能一边打开Python官方的参考手册，一边 学习编程。有了tab补全以后，即使他对函数名称不是特别熟悉也没有关系，可以先通过tab补全列出当 前命名空间下的函数列表，然后根据函数名称选择自己需要的函数。IPython的补全功能非常强大，不 但可以补全用户的变量名、标准库的函数，在导入包时也可以进行补全。</p>
<p>这一小节，我们一直在强调IPython比标准的Python Shell更好用，拥有更多高级功能。如果读者接触 Python的时间不长，也许不能理解为什么需要使用交互式编程。交互式编程在当前会话退出以后就结束 了，并不满足计算机程序一次编写多次运行的特点。但是，在我们的日常工作中还是会经常用到交互式编程。</p>
<p>交互式编程不但可以快速验证代码执行结果，还可以帮助我们学习Python编程。Python工程师在编写 代码时，通常会使用编辑器和Python Shell组合的方式来完成程序的编写，例如，将代码从编辑器复制 到Python Shell以验证代码的正确性，然后将验证过的代码从Python Shell复制到编辑器中。</p>
<h5 id="（2）使用IPython来解析MySQL的备份日志"><a href="#（2）使用IPython来解析MySQL的备份日志" class="headerlink" title="（2）使用IPython来解析MySQL的备份日志"></a>（2）使用IPython来解析MySQL的备份日志</h5><p>为了便于读者理解交互式编程的好处，我们这里演示一个使用Python交互式编程的例子。在这个例子 中，我们使用IPython来解析MySQL的备份日志。</p>
<p>一个典型的MySQL物理备份日志如下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token number">170221</span> 01:07:48 Executing UNLOCK TABLES
<span class="token number">170221</span> 01:07:48 All tables unlocked
Starting slave SQL thread
<span class="token number">170221</span> 01:07:48 <span class="token punctuation">[</span>00<span class="token punctuation">]</span> Streaming ib_buffer_pool to <span class="token operator">&lt;</span>STDOUT<span class="token operator">></span>
<span class="token number">170221</span> 01:07:48 <span class="token punctuation">[</span>00<span class="token punctuation">]</span> <span class="token punctuation">..</span>.done
<span class="token number">170221</span> 01:07:48 Backup created <span class="token keyword">in</span> directory <span class="token string">'/home/lmx/log/backup'</span>
MySQL binlog position: filename <span class="token string">'mysql-bin.000003'</span>, position <span class="token string">'507946128'</span>,
GTID of the last change <span class="token string">'5a81ea97-daf1-11e6-94c1-fa163ee35df3:1-3409440'</span>
MySQL slave binlog position: master <span class="token function">host</span> <span class="token string">'10.173.33.35'</span>, filename <span class="token string">'mysqlbin.000002'</span>, position <span class="token string">'524993060'</span>
<span class="token number">170221</span> 01:07:48 <span class="token punctuation">[</span>00<span class="token punctuation">]</span> Streaming backup-my.cnf
<span class="token number">170221</span> 01:07:48 <span class="token punctuation">[</span>00<span class="token punctuation">]</span> <span class="token punctuation">..</span>.done
<span class="token number">170221</span> 01:07:48 <span class="token punctuation">[</span>00<span class="token punctuation">]</span> Streaming xtrabackup_info
<span class="token number">170221</span> 01:07:48 <span class="token punctuation">[</span>00<span class="token punctuation">]</span> <span class="token punctuation">..</span>.done
xtrabackup: Transaction log of lsn <span class="token punctuation">(</span><span class="token number">3387315364</span><span class="token punctuation">)</span> to <span class="token punctuation">(</span><span class="token number">3451223966</span><span class="token punctuation">)</span> was copied.
<span class="token number">170221</span> 01:07:48 completed OK<span class="token operator">!</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>即使读者对MySQL不了解也没有关系，我们现在的需求是解析下面这一行日志，并获取日志中的host、 filename和position的值。虽然在日志中position的值包含在一对单引号内，但是，我们希望解析以后 position的值是一个整数。</p>
<pre class="line-numbers language-tex" data-language="tex"><code class="language-tex">MySQL slave binlog position: master host &#39;10.173.33.35&#39;, filename &#39;mysqlbin.000002&#39;, position &#39;524993060&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>在这个例子中，主要就是对字符串进行处理，并提取相应的值。这个问题当然不难，但是，如果不借助 交互式编程工具，需要工程师一次在代码中编写正确也不简单。如果工程师不知道交互式编程工具，就 只能在编辑器里面编写代码，然后运行。如果有错误再修改，直到获取正确的取值，整个过程将会非常 耗时。如果项目庞大，调试起来也会比较困难。这个时候就可以借助Python的交互式编程工具，先验证 代码的正确性，然后将验证过的代码从交互式编程工具复制到编辑器中。如下所示：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span>root@localhost <span class="token operator">~</span><span class="token punctuation">]</span><span class="token comment"># ipython</span>
Python <span class="token number">3.8</span><span class="token number">.1</span> <span class="token punctuation">(</span>default<span class="token punctuation">,</span> Jan <span class="token number">14</span> <span class="token number">2020</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token number">36</span><span class="token punctuation">)</span>
Type <span class="token string">'copyright'</span><span class="token punctuation">,</span> <span class="token string">'credits'</span> <span class="token keyword">or</span> <span class="token string">'license'</span> <span class="token keyword">for</span> more information
IPython <span class="token number">7.11</span><span class="token number">.1</span> <span class="token operator">-</span><span class="token operator">-</span> An enhanced Interactive Python<span class="token punctuation">.</span> Type <span class="token string">'?'</span> <span class="token keyword">for</span> <span class="token builtin">help</span><span class="token punctuation">.</span>
In <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span> line<span class="token operator">=</span>"MySQL slave binlog position<span class="token punctuation">:</span> master host <span class="token string">'10.173.33.35'</span><span class="token punctuation">,</span>
filename <span class="token string">'mysql-bin.000002'</span><span class="token punctuation">,</span> position <span class="token string">'524993060'</span>"
In <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"'"</span><span class="token punctuation">)</span>
Out<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
<span class="token punctuation">[</span><span class="token string">'MySQL slave binlog position: master host '</span><span class="token punctuation">,</span>
<span class="token string">'10.173.33.35'</span><span class="token punctuation">,</span>
<span class="token string">', filename '</span><span class="token punctuation">,</span>
<span class="token string">'mysql-bin.000002'</span><span class="token punctuation">,</span>
<span class="token string">', position '</span><span class="token punctuation">,</span>
<span class="token string">'524993060'</span><span class="token punctuation">,</span>
<span class="token string">''</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span> host<span class="token operator">=</span>line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span> filename<span class="token operator">=</span>line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span> position<span class="token operator">=</span>line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span>filename<span class="token punctuation">,</span>position<span class="token punctuation">)</span>
<span class="token number">10.173</span><span class="token number">.33</span><span class="token number">.35</span> mysql<span class="token operator">-</span><span class="token builtin">bin</span><span class="token number">.000002</span> <span class="token number">524993060</span>
In <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token builtin">type</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span>
Out<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token builtin">str</span>
In <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">:</span> position<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span>
In <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span>filename<span class="token punctuation">,</span>position<span class="token punctuation">)</span>
<span class="token number">10.173</span><span class="token number">.33</span><span class="token number">.35</span> mysql<span class="token operator">-</span><span class="token builtin">bin</span><span class="token number">.000002</span> <span class="token number">524993060</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>为了节省文章篇幅，我们没有进行错误的尝试，而是直接通过单引号来分解字符串。由于我们使用了交 互式编程，可以很方便地看到字符串分解以后的中间结果。正是有了这个中间结果，我们才知道，字符 串分解成列表以后，下标1对应的字符串是host的值，下标3对应的字符串是filename的值，下标5对应 的字符串是position的值。我们还可以通过交互式编程发现position是一个字符串。由于我们要求 position是一个整数，因此，需要在代码中将position强制转换为一个整数。</p>
<p>如果读者自己尝试从这一行字符串中获取有效的值，很可能一开始会尝试使用逗号或空格来分解字符 串。这两种方法都无法一次取出host、filename和position的值。如下所示：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
Out<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
<span class="token punctuation">[</span><span class="token string">"MySQL slave binlog position: master host '10.173.33.35'"</span><span class="token punctuation">,</span>
<span class="token string">" filename 'mysql-bin.000002'"</span><span class="token punctuation">,</span>
<span class="token string">" position '524993060'"</span><span class="token punctuation">]</span>

In <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">:</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>
Out<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
<span class="token punctuation">[</span><span class="token string">'MySQL'</span><span class="token punctuation">,</span>
<span class="token string">'slave'</span><span class="token punctuation">,</span>
<span class="token string">'binlog'</span><span class="token punctuation">,</span>
<span class="token string">'position:'</span><span class="token punctuation">,</span>
<span class="token string">'master'</span><span class="token punctuation">,</span>
<span class="token string">'host'</span><span class="token punctuation">,</span>
<span class="token string">"'10.173.33.35',"</span><span class="token punctuation">,</span>
<span class="token string">'filename'</span><span class="token punctuation">,</span>
<span class="token string">"'mysql-bin.000002',"</span><span class="token punctuation">,</span>
<span class="token string">'position'</span><span class="token punctuation">,</span>
<span class="token string">"'524993060'"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>使用交互式编程，我们可以快速尝试不同的方案，先验证自己的想法是否正确，然后将代码拷贝到编辑 器中，组成我们的Python程序文件。通过这种方式，能够有效降低代码出错的概率，减少调试的时间， 从而提高工作效率。</p>
<h5 id="（3）更好地获取帮助信息"><a href="#（3）更好地获取帮助信息" class="headerlink" title="（3）更好地获取帮助信息"></a>（3）更好地获取帮助信息</h5><p>Python工程师不但可以通过交互式编程快速验证代码执行结果，还可以通过交互式编程的方式学习 Python编程。之所以说Python工程师可以通过交互式编程学习编程，是因为使用IPython能够方便地获 取到相应的帮助信息。如命名空间下的每个对象以及其定义和使用说明。虽然标准的Python Shell也可 以通过help函数获取到对象的帮助信息，但是，IPython提供了更加灵活的方式获取命名空间下的对象 列表，以及更加全面的帮助信息。 </p>
<p>我们知道，在标准库的os模块下的path子模块中有很多操作文件、目录和路径的函数，也有很多 以”is”开始的判断类函数。这些判断类函数的作用非常明确，用以判断给定的对象是否为一个文件或一 个目录。我们可以使用通配符的方式获取该模块下的所有判断类函数，如下所示：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">import</span> os
In <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">:</span> ?os<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token keyword">is</span><span class="token operator">*</span>
os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isabs
os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir
os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile
os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>islink
os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>ismount<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>获取当前命名空间下的所有对象，除了使用通配符的方式以外，也可以使用前面介绍的tab补全方式。 tab补全的方式更加实用一些，就如同IPython提供的获取帮助信息的方式比标准的Python Shell获取帮 助信息更实用一样。在IPython中，可以通过标准的help函数获取对象的帮助信息，也可以使用“？”和 “？？”获取对象的帮助信息，如下所示：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">import</span> json
In <span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">import</span> os
In <span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">:</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile?
Signature<span class="token punctuation">:</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
Docstring<span class="token punctuation">:</span> Test whether a path <span class="token keyword">is</span> a regular <span class="token builtin">file</span>
File<span class="token punctuation">:</span> <span class="token operator">~</span><span class="token operator">/</span><span class="token punctuation">.</span>pyenv<span class="token operator">/</span>versions<span class="token operator">/</span><span class="token number">3.8</span><span class="token number">.1</span><span class="token operator">/</span>lib<span class="token operator">/</span>python3<span class="token punctuation">.</span><span class="token number">8</span><span class="token operator">/</span>genericpath<span class="token punctuation">.</span>py
Type<span class="token punctuation">:</span> function

In <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">:</span> json<span class="token punctuation">.</span>dump?

Signature<span class="token punctuation">:</span>
json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>
obj<span class="token punctuation">,</span>
fp<span class="token punctuation">,</span>
<span class="token operator">*</span><span class="token punctuation">,</span>
skipkeys<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
ensure_ascii<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
check_circular<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
allow_nan<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
cls<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
indent<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
separators<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
sort_keys<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
<span class="token operator">**</span>kw<span class="token punctuation">,</span>
<span class="token punctuation">)</span>
Docstring<span class="token punctuation">:</span>
Serialize ``obj`` <span class="token keyword">as</span> a JSON formatted stream to ``fp`` <span class="token punctuation">(</span>a
``<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token punctuation">)</span>``<span class="token operator">-</span>supporting <span class="token builtin">file</span><span class="token operator">-</span>like <span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">.</span>

If ``skipkeys`` <span class="token keyword">is</span> true then ``<span class="token builtin">dict</span>`` keys that are <span class="token keyword">not</span> basic types
<span class="token punctuation">(</span>``<span class="token builtin">str</span>``<span class="token punctuation">,</span> ``<span class="token builtin">int</span>``<span class="token punctuation">,</span> ``<span class="token builtin">float</span>``<span class="token punctuation">,</span> ``<span class="token builtin">bool</span>``<span class="token punctuation">,</span> ``<span class="token boolean">None</span>``<span class="token punctuation">)</span> will be skipped
instead of raising a ``TypeError``<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>当我们输入对象名称，再输入一个问号以后按回车键，就会显示相应的帮助信息。如果帮助信息比较 长，则会以分页的方式显示帮助信息。如果因为帮助信息太多而进入了分页页面，可以通过“q”键退出， 退出以后可以继续进行编程。</p>
<p>例如，json这个标准库下有一个dump函数和一个dumps函数，Python初学者总是容易混淆。这个时 候，如果能够充分利用IPython，就可以方便地获取到帮助信息，使用时不容易犯错。下面就是一个典 型的Python工程师使用json模块的方式，先构造了一个字典，希望将字典转换成json字符串。因为不知 道应该使用json.dump函数还是json.dumps函数，所以，在交互式编程中通过“json.dump?”语句获取dump函数的帮助信息。获取完json.dump函数的帮助信息以后，按“q”键退出，退出以后继续进行编 程。如下所示：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">import</span> json
In <span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">:</span> d<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>a<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>b<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>c<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
In <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">:</span> json<span class="token punctuation">.</span>dump?
In <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">:</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
Out<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'&#123;"a": 1, "b": 2, "c": 3&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在IPython中，除了使用一个问号获取帮助信息以外，也可以使用两个问号获取帮助信息。两个问号获 取到的帮助信息更加全面，甚至会包含函数的实现源码。</p>
<p>除了使用问号的方式获取对象的帮助信息以外，IPython还提供了另外一种方式获取对象的信息，可以 分别获取对象的定义、文档和文件等。如下所示：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">import</span> json
In <span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token operator">%</span>pdef json
Object <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token builtin">callable</span><span class="token punctuation">.</span>
In <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token operator">%</span>pdef json<span class="token punctuation">.</span>dump
json<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>
obj<span class="token punctuation">,</span>
fp<span class="token punctuation">,</span>
<span class="token operator">*</span><span class="token punctuation">,</span>
skipkeys<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
ensure_ascii<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
check_circular<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
allow_nan<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
cls<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
indent<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
separators<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
sort_keys<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
<span class="token operator">**</span>kw<span class="token punctuation">,</span>
<span class="token punctuation">)</span>
In <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token operator">%</span>pfile json<span class="token punctuation">.</span>dump
In <span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token operator">%</span>pdoc json<span class="token punctuation">.</span>dump
In <span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token operator">%</span>pinfo json<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="（4）magic函数"><a href="#（4）magic函数" class="headerlink" title="（4）magic函数"></a>（4）magic函数</h5><p>IPython提供了很多功能强大的函数，如前面已经提到的%pfile、%pdoc、%pinfo等。为了区分 IPython提供的函数和用户的输入，所有IPython提供的函数都以“%”开头。以“%”开头的这类功能强大的 函数，在IPython中称为magic函数。magic函数主要是为IPython提供增强的功能、与操作系统交互、 操纵用户的输入和输出以及对IPython进行配置。</p>
<p>IPython会将任何第一个字母为“%”的行，视为对magic函数的特殊调用。因此，所有的magic函数都是 以“%”开头。在IPython中，有两种不同的方法可以获取magic函数列表，分别是通过“%”获取所有的 magic函数和通过“%lsmagic”获取所有的magic函数。</p>
<p>下面是一个用lsmagic函数获取magic函数列表的例子：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token operator">%</span>lsmagic
Out<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
Available line magics<span class="token punctuation">:</span>
<span class="token operator">%</span>alias <span class="token operator">%</span>alias_magic <span class="token operator">%</span>autoawait <span class="token operator">%</span>autocall <span class="token operator">%</span>autoindent <span class="token operator">%</span>automagic
<span class="token operator">%</span>bookmark <span class="token operator">%</span>cat <span class="token operator">%</span>cd <span class="token operator">%</span>clear <span class="token operator">%</span>colors <span class="token operator">%</span>conda <span class="token operator">%</span>config <span class="token operator">%</span>cp <span class="token operator">%</span>cpaste
<span class="token operator">%</span>debug <span class="token operator">%</span>dhist <span class="token operator">%</span>dirs <span class="token operator">%</span>doctest_mode <span class="token operator">%</span>ed <span class="token operator">%</span>edit <span class="token operator">%</span>env <span class="token operator">%</span>gui <span class="token operator">%</span>hist
<span class="token operator">%</span>history <span class="token operator">%</span>killbgscripts <span class="token operator">%</span>ldir <span class="token operator">%</span>less <span class="token operator">%</span>lf <span class="token operator">%</span>lk <span class="token operator">%</span>ll <span class="token operator">%</span>load <span class="token operator">%</span>load_ext
<span class="token operator">%</span>loadpy <span class="token operator">%</span>logoff <span class="token operator">%</span>logon <span class="token operator">%</span>logstart <span class="token operator">%</span>logstate <span class="token operator">%</span>logstop <span class="token operator">%</span>ls <span class="token operator">%</span>lsmagic
<span class="token operator">%</span>lx <span class="token operator">%</span>macro <span class="token operator">%</span>magic <span class="token operator">%</span>man <span class="token operator">%</span>matplotlib <span class="token operator">%</span>mkdir <span class="token operator">%</span>more <span class="token operator">%</span>mv <span class="token operator">%</span>notebook
<span class="token operator">%</span>page <span class="token operator">%</span>paste <span class="token operator">%</span>pastebin <span class="token operator">%</span>pdb <span class="token operator">%</span>pdef <span class="token operator">%</span>pdoc <span class="token operator">%</span>pfile <span class="token operator">%</span>pinfo <span class="token operator">%</span>pinfo2 <span class="token operator">%</span>pip
<span class="token operator">%</span>popd <span class="token operator">%</span>pprint <span class="token operator">%</span>precision <span class="token operator">%</span>prun <span class="token operator">%</span>psearch <span class="token operator">%</span>psource <span class="token operator">%</span>pushd <span class="token operator">%</span>pwd <span class="token operator">%</span>pycat
<span class="token operator">%</span>pylab <span class="token operator">%</span>quickref <span class="token operator">%</span>recall <span class="token operator">%</span>rehashx <span class="token operator">%</span>reload_ext <span class="token operator">%</span>rep <span class="token operator">%</span>rerun <span class="token operator">%</span>reset
<span class="token operator">%</span>reset_selective <span class="token operator">%</span>rm <span class="token operator">%</span>rmdir <span class="token operator">%</span>run <span class="token operator">%</span>save <span class="token operator">%</span>sc <span class="token operator">%</span>set_env <span class="token operator">%</span>store <span class="token operator">%</span>sx
<span class="token operator">%</span>system <span class="token operator">%</span>tb <span class="token operator">%</span>time <span class="token operator">%</span>timeit <span class="token operator">%</span>unalias <span class="token operator">%</span>unload_ext <span class="token operator">%</span>who <span class="token operator">%</span>who_ls <span class="token operator">%</span>whos
<span class="token operator">%</span>xdel <span class="token operator">%</span>xmode

Available cell magics<span class="token punctuation">:</span>
<span class="token operator">%</span><span class="token operator">%</span>! <span class="token operator">%</span><span class="token operator">%</span>HTML <span class="token operator">%</span><span class="token operator">%</span>SVG <span class="token operator">%</span><span class="token operator">%</span>bash <span class="token operator">%</span><span class="token operator">%</span>capture <span class="token operator">%</span><span class="token operator">%</span>debug <span class="token operator">%</span><span class="token operator">%</span><span class="token builtin">file</span> <span class="token operator">%</span><span class="token operator">%</span>html <span class="token operator">%</span><span class="token operator">%</span>javascript
<span class="token operator">%</span><span class="token operator">%</span>js <span class="token operator">%</span><span class="token operator">%</span>latex <span class="token operator">%</span><span class="token operator">%</span>markdown <span class="token operator">%</span><span class="token operator">%</span>perl <span class="token operator">%</span><span class="token operator">%</span>prun <span class="token operator">%</span><span class="token operator">%</span>pypy <span class="token operator">%</span><span class="token operator">%</span>python <span class="token operator">%</span><span class="token operator">%</span>python2
<span class="token operator">%</span><span class="token operator">%</span>python3 <span class="token operator">%</span><span class="token operator">%</span>ruby <span class="token operator">%</span><span class="token operator">%</span>script <span class="token operator">%</span><span class="token operator">%</span>sh <span class="token operator">%</span><span class="token operator">%</span>svg <span class="token operator">%</span><span class="token operator">%</span>sx <span class="token operator">%</span><span class="token operator">%</span>system <span class="token operator">%</span><span class="token operator">%</span>time <span class="token operator">%</span><span class="token operator">%</span>timeit
<span class="token operator">%</span><span class="token operator">%</span>writefile

Automagic <span class="token keyword">is</span> ON<span class="token punctuation">,</span> <span class="token operator">%</span> prefix IS NOT needed <span class="token keyword">for</span> line magics<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以看到，IPython提供了很多magic函数。并且，随着IPython的功能越来越多，magic函数还会不断 增加。那么，有没有一种好的方法能够快速了解magic函数的用法呢？前面介绍的通过问号获取对象帮 助信息的方法对magic函数也适用。因此，只要输入一个magic函数，后面再输入一个问号，回车以后 就能够看到这个magic函数的帮助信息。如下所示：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token operator">%</span>save?
Docstring<span class="token punctuation">:</span>
Save a <span class="token builtin">set</span> of lines <span class="token keyword">or</span> a macro to a given filename<span class="token punctuation">.</span>

Usage<span class="token punctuation">:</span>
	<span class="token operator">%</span>save <span class="token punctuation">[</span>options<span class="token punctuation">]</span> filename n1<span class="token operator">-</span>n2 n3<span class="token operator">-</span>n4 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> n5 <span class="token punctuation">.</span><span class="token punctuation">.</span> n6 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

Options<span class="token punctuation">:</span>
     
	<span class="token operator">-</span>r<span class="token punctuation">:</span> use <span class="token string">'raw'</span> <span class="token builtin">input</span><span class="token punctuation">.</span> By default<span class="token punctuation">,</span> the <span class="token string">'processed'</span> history <span class="token keyword">is</span> 	used<span class="token punctuation">,</span>so that magics are loaded <span class="token keyword">in</span> their transformed version 	to validPython<span class="token punctuation">.</span> If this option <span class="token keyword">is</span> given<span class="token punctuation">,</span> the raw <span class="token builtin">input</span> <span class="token keyword">as</span> 		typed <span class="token keyword">as</span> thecommand line <span class="token keyword">is</span> used instead<span class="token punctuation">.</span>

	<span class="token operator">-</span>f<span class="token punctuation">:</span> force overwrite<span class="token punctuation">.</span> If <span class="token builtin">file</span> exists<span class="token punctuation">,</span> <span class="token operator">%</span>save will prompt <span class="token keyword">for</span> 		overwriteunless <span class="token operator">-</span>f <span class="token keyword">is</span> given<span class="token punctuation">.</span>

	<span class="token operator">-</span>a<span class="token punctuation">:</span> append to the <span class="token builtin">file</span> instead of overwriting it<span class="token punctuation">.</span>
<span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>IPython的官方文档将magic函数分为三类，分别是：</p>
<pre class="line-numbers language-tex" data-language="tex"><code class="language-tex">1）操作代码的magic函数，如%run、%edit、%save、%macro、%recall；
2）控制IPython的magic函数，如%colors、%xmode、%autoindent、%automagic；
3）其他magic函数，如%reset、%timeit、%%writefile、%load、%paste。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>为了演示magic函数的使用，我们来看一个实际的例子。假设你是一名DBA，并且非常喜欢Python这门 编程语言，会经常使用Python管理MySQL。因此，你经常需要使用Python连接MySQL执行SQL语句 （Python连接MySQL的知识将在11章介绍）。使用Python执行SQL语句，对于普通的查询语句，返回 的结果将是一个二维的元组。但是，如果执行的是一些管理类的SQL语句或者监控类的SQL语句， Python驱动将会以怎样的方式返回MySQL的查询结果呢？</p>
<p>例如，需要执行下面的SQL语句，并获取返回结果：</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">show</span> slave <span class="token keyword">status</span>；
<span class="token keyword">show</span> master <span class="token keyword">status</span>；
<span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'%innodb%buffer%'</span>；
<span class="token keyword">show</span> <span class="token keyword">status</span> <span class="token operator">like</span> <span class="token string">'%select%'</span>；
<span class="token keyword">set</span> <span class="token keyword">global</span> innodb_buffer_pool_dump_pct <span class="token operator">=</span> <span class="token number">30</span>；
<span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span> <span class="token punctuation">.</span> <span class="token keyword">TO</span> <span class="token punctuation">[</span><span class="token string">'lmx'</span><span class="token variable">@'localhost'</span><span class="token punctuation">]</span><span class="token punctuation">(</span>mailto:<span class="token string">'lmx'</span><span class="token variable">@'localhost'</span><span class="token punctuation">)</span>
<span class="token keyword">WITH</span> <span class="token keyword">GRANT</span> <span class="token keyword">OPTION</span>。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>为了得到Python执行上面SQL语句的结果，需要在Python中连接MySQL并进行认证。认证完成以后执 行SQL语句获取输出。由于你经常需要验证SQL语句，因此，使用Python连接MySQL并认证这些代码需 要反复输入。为了节省输入时间，我们可以将Python连接MySQL并认证的逻辑保存到外部文件中，在 需要的时候通过%load这个magic函数将外部代码导入到IPython中执行即可。例如，我们在一个名为 connect.py的外部文件中保存了连接MySQL的代码，在Ipython中使用%load导入外部Python文件：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token operator">%</span>load connect<span class="token punctuation">.</span>py
     
In <span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token keyword">import</span> MySQLdb <span class="token keyword">as</span> db
conn <span class="token operator">=</span> db<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"localhost"</span><span class="token punctuation">,</span> db<span class="token operator">=</span><span class="token string">"test"</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token string">'lmx'</span><span class="token punctuation">,</span>
passwd<span class="token operator">=</span><span class="token string">'my_passwd'</span><span class="token punctuation">,</span> unix_socket<span class="token operator">=</span><span class="token string">'/tmp/mysql.sock'</span><span class="token punctuation">)</span>
cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
sql <span class="token operator">=</span> <span class="token string">"select 1"</span>
cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
rows <span class="token operator">=</span> cur<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> rows
<span class="token punctuation">(</span><span class="token punctuation">(</span>1L<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>使用%load命令导入外部的Python文件并执行以后，可以继续使用已经建立的MySQL连接执行SQL语 句。这个例子主要用以演示magic函数的用法，IPython提供了大量的magic函数，每一个magic函数的 具体用法都可以通过问号表达式获取相应的帮助文档。</p>
<h5 id="（5）保存历史"><a href="#（5）保存历史" class="headerlink" title="（5）保存历史"></a>（5）保存历史</h5><p>保存编码历史这方面，IPython相比标准的Python Shell有了质的提升。用户可以非常灵活地操作 IPython的输入历史和输出历史。下面我们简单看几个例子：</p>
<blockquote>
<p>_i, _ii, _iii 分别保存了最近的三次输入； _, , _ 分别保存了最近的三次输出； 可以像Bash一样，通 过ctrl+p, ctrl+n查找输入； 可以像Bash一样，使用ctrl+r进行反向查找； IPython的输入历史在 当前会话退出以后会进行持久化，下一次进入IPython时，依然可以查找前一次会话的输入历史； %edit IPython可以通过%edit编辑历史输入并重新执行； %save IPython可以通过%save将 IPython中的代码保存到程序文件中； %rerun IPython可以指定代码行数重新运行；</p>
</blockquote>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token operator">%</span>rerun <span class="token number">21</span>
<span class="token operator">==</span><span class="token operator">=</span> Executing<span class="token punctuation">:</span> <span class="token operator">==</span><span class="token operator">=</span>
json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token operator">==</span><span class="token operator">=</span> Output<span class="token punctuation">:</span> <span class="token operator">==</span><span class="token operator">=</span>
Out<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'&#123;"a": 1, "b": 2, "c": 3&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="（6）与操作系统交互"><a href="#（6）与操作系统交互" class="headerlink" title="（6）与操作系统交互"></a>（6）与操作系统交互</h5><p>IPython比标准的Python Shell好用的另一个理由是，它能够更好地与操作系统进行交互。在使用 Python进行交互式编程时，不用退出Python Shell就可以执行Linux命令。magic函数里的%cd和%pwd 作用相当于Linux下的cd命令和pwd命令。此外，在IPython中，可以通过“!cmd”的形式执行任何Linux 命令。如下所示：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token operator">%</span>ls
anaconda<span class="token operator">-</span>ks<span class="token punctuation">.</span>cfg initial<span class="token operator">-</span>setup<span class="token operator">-</span>ks<span class="token punctuation">.</span>cfg Python<span class="token operator">-</span><span class="token number">3.8</span><span class="token number">.1</span><span class="token operator">/</span> Python<span class="token operator">-</span><span class="token number">3.8</span><span class="token number">.1</span><span class="token punctuation">.</span>tgz
In <span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token operator">%</span>pwd
Out<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'/root'</span>
In <span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">:</span> ! wc <span class="token operator">-</span>l <span class="token operator">/</span>tmp<span class="token operator">/</span>storage<span class="token punctuation">.</span>log
<span class="token number">0</span> <span class="token operator">/</span>tmp<span class="token operator">/</span>storage<span class="token punctuation">.</span>log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>也可以通过赋值的方式捕获命令的输出：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token operator">=</span>!df
In <span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data
Out<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
<span class="token punctuation">[</span><span class="token string">'文件系统 			   1K-块    	  已用      可用       已用%      挂载点'</span><span class="token punctuation">,</span>
<span class="token string">'/dev/mapper/centos-root 17811456 		6060988  11750468   35%  	/'</span><span class="token punctuation">,</span>
<span class="token string">'devtmpfs 			480872               0  480872     0%    	/dev'</span><span class="token punctuation">,</span>
<span class="token string">'tmpfs 				497948               0  497948     0% 		/dev/shm'</span><span class="token punctuation">,</span>
<span class="token string">'tmpfs                   497948            8696  489252     2% 		/run'</span><span class="token punctuation">,</span>
<span class="token string">'tmpfs                   497948               0  497948     0% 	     /sys/fs/cgroup'</span><span class="token punctuation">,</span>
<span class="token string">'/dev/sda1               1038336         169504  868832     17% 		/boot'</span><span class="token punctuation">,</span>
<span class="token string">'tmpfs                   99592               64  99528      1% 	     /run/user/1000'</span><span class="token punctuation">,</span>
<span class="token string">'tmpfs                   99592                0  99592      0% 		/run/user/0'</span><span class="token punctuation">]</span>
In <span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">:</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>
Out<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'35%'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在Python生态中，除了IPython这个增强的Python Shell以外，还有bython和ptpython这两个不错的 Python Shell。后面这两个工具都有自己的特色，但是都没有IPython使用广泛。而且，由于IPython使 用最为广泛，很多开源项目（如流行的爬虫框架Scrapy）对IPython进行了集成，所以，建议读者学习 IPython。</p>
<h4 id="3-3、-jupyter的使用"><a href="#3-3、-jupyter的使用" class="headerlink" title="3.3、 jupyter的使用"></a>3.3、 jupyter的使用</h4><h5 id="（1）、jupyter介绍"><a href="#（1）、jupyter介绍" class="headerlink" title="（1）、jupyter介绍"></a>（1）、jupyter介绍</h5><p>jupyter就是以前的IPython Notebook，是一种新兴的交互式数据分析与记录工具。它通过浏览器访问 本地或者远端的IPython进程，并利用浏览器的图形界面，增强IPython的可视化输出。jupyter定义了 一种全新的文件格式，文件的后缀名是ipynb。ipynb文件包含了代码，用以说明每一步的计算和输出。 也就是说，ipynb文件完整记录了计算过程中的所有相关信息，并且，能够支持图片、视频和公式等副 文本格式，是科学计算、数据分析和编程教学的优秀工具。</p>
<p>正是由于jupyter丰富的可视化输出，其广泛应用于以下场景：</p>
<pre class="line-numbers language-tex" data-language="tex"><code class="language-tex">编程教学；
数据分析；
科学计算；
幻灯片演示。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="（2）、-jupyter-notebook的使用"><a href="#（2）、-jupyter-notebook的使用" class="headerlink" title="（2）、 jupyter notebook的使用"></a>（2）、 jupyter notebook的使用</h5><p>IPython Shell与jupyter分离以后，jupyter需要额外进行安装。直接使用pip安装即可：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pip install jupyter</span>
Looking <span class="token keyword">in</span> indexes: https://pypi.douban.com/simple/
Collecting jupyter
Downloading
https://pypi.doubanio.com/packages/83/df/0f5dd132200728a86190397e1ea87cd762
44e42d39ec5e88efd25b2abd7e/jupyter-1.0.0-py2.py3-none-any.whl
……省略部分信息
Successfully installed MarkupSafe-1.1.1 Send2Trash-1.5.0 attrs-19.3.0
bleach-3.1.0 defusedxml-0.6.0 entrypoints-0.3 ipykernel-5.1.3 ipywidgets7.5.1 jinja2-2.10.3 jsonschema-3.2.0 jupyter-1.0.0 jupyter-client-5.3.4
jupyter-console-6.0.0 jupyter-core-4.6.1 mistune-0.8.4 nbconvert-5.6.1
nbformat-5.0.3 notebook-6.0.2 pandocfilters-1.4.2 prometheus-client-0.7.1
prompt-toolkit-2.0.10 pyrsistent-0.15.7 python-dateutil-2.8.1 pyzmq-18.1.1
qtconsole-4.6.0 terminado-0.8.3 testpath-0.4.4 tornado-6.0.3 webencodings0.5.1 widgetsnbextension-3.5.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>由于我们是在Linux下安装jupyter，如果我们的Linux没有图形界面，可以通过设置–no-browser和设 置–ip&#x3D;0.0.0.0进行外部访问，如果不指定–ip参数，默认IP是localhost，也就是只有本地才能访问。如 下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># jupyter notebook --no-browser --ip=0.0.0.0 --allow-root</span>
<span class="token punctuation">[</span>I <span class="token number">13</span>:06:33.656 NotebookApp<span class="token punctuation">]</span> 启动notebooks 在本地路径: /root
<span class="token punctuation">[</span>I <span class="token number">13</span>:06:33.657 NotebookApp<span class="token punctuation">]</span> 本程序运行在: http://localhost:8888/?
<span class="token assign-left variable">token</span><span class="token operator">=</span>33fdb8256c7c1d13a23b8189ea0f4e7b7f434f14cc07ea5e
<span class="token punctuation">[</span>I <span class="token number">13</span>:06:33.657 NotebookApp<span class="token punctuation">]</span> or http://127.0.0.1:8888/?
<span class="token assign-left variable">token</span><span class="token operator">=</span>33fdb8256c7c1d13a23b8189ea0f4e7b7f434f14cc07ea5e
<span class="token punctuation">[</span>I <span class="token number">13</span>:06:33.657 NotebookApp<span class="token punctuation">]</span> 使用control-c停止此服务器并关闭所有内核<span class="token punctuation">(</span>两次跳过确认<span class="token punctuation">)</span>.
<span class="token punctuation">[</span>C <span class="token number">13</span>:06:33.727 NotebookApp<span class="token punctuation">]</span>

	To access the notebook, <span class="token function">open</span> this <span class="token function">file</span> <span class="token keyword">in</span> a browser:
		file:///root/.local/share/jupyter/runtime/nbserver-3998-open.html
	Or copy and <span class="token function">paste</span> one of these URLs:
		http://localhost:8888/?
<span class="token assign-left variable">token</span><span class="token operator">=</span>33fdb8256c7c1d13a23b8189ea0f4e7b7f434f14cc07ea5e
	or http://127.0.0.1:8888/?
<span class="token assign-left variable">token</span><span class="token operator">=</span>33fdb8256c7c1d13a23b8189ea0f4e7b7f434f14cc07ea5e<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>从jupyter notebook的输出结果可以看到，jupyter notebook命令给出了一个URL，我们只需将该URL 拷贝至浏览器中，然后将0.0.0.0替换为Linux服务器的IP即可。</p>
<blockquote>
<p>在Windows下可以使用远程连接工具xmanager来操作</p>
</blockquote>
<p>通过浏览器访问jupyter给我们的URL，就可以登录到jupyter的主界面。这个界面会显示当前目录下的 所有文件<br><img src="https://img-blog.csdnimg.cn/20200427203400246.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTYzNjcwMg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>登录jupyter的主界面后，我们如果要创建一个文件，只需要单击“新建”，选择你希望启动的Notebook 类型即可。我们选择Python 3。选择Python 3以后，浏览器会打开一个新的页面。在这个新的页面中， 可以看到一个空的Notebook界面。</p>
<p>jupyter界面由以下部分组成：</p>
<pre class="line-numbers language-tex" data-language="tex"><code class="language-tex">标题栏
菜单栏
快捷键
编辑区<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>在菜单栏中有一个“帮助”选项，读者可以通过该选项得到jupyter的使用说明。jupyter本身是图形界面的 应用，使用比较简单，因此，本教程不会花很多篇幅来介绍jupyter的使用。<br><img src="https://img-blog.csdnimg.cn/20200427203426132.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTYzNjcwMg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>在jupyter的编辑区中默认有一个输入框。输入框在jupyter中称为cell。我们可以通过菜单栏的“cell”选项 控制cell的格式、执行cell的代码。与此同时，我们也可以通过快捷键控制cell，如ctrl+enter快捷键用以 执行cell中的代码，shift+enter快捷键用以执行当前cell中的代码，并且在当前cell下方创建一个新的 cell。<br><img src="https://img-blog.csdnimg.cn/20200427203444853.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTYzNjcwMg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>jupyter之所以能够进行编程教学和幻灯片演示，是因为它可以支持富文本格式和markdown格式。我们 只需修改cell的类型为“Markdown”，就可以在cell中使用markdown语句进行输入了。我们也可以在 jupyter中画图。为了在jupyter中画图，我们需要先安装matplotlib。如下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pip install matplotlib</span>
Looking <span class="token keyword">in</span> indexes: https://pypi.douban.com/simple/
Collecting matplotlib
Downloading
https://pypi.doubanio.com/packages/53/6c/7b400d45f0ecd6703b2779a7dfda657857
9a353748e1b43d8353cb7f5b7f/matplotlib-3.1.2-cp38-cp38-manylinux1_x86_64.whl
<span class="token punctuation">(</span><span class="token number">13</span>.1MB<span class="token punctuation">)</span>
<span class="token operator">|</span>████████████████████████████████<span class="token operator">|</span> <span class="token number">13</span>.1MB <span class="token number">1</span>.8MB/s
……省略部分信息
Installing collected packages: kiwisolver, numpy, pyparsing, cycler,
matplotlib
Successfully installed cycler-0.10.0 kiwisolver-1.1.0 matplotlib-3.1.2
numpy-1.18.1 pyparsing-2.4.6<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>安装matplotlib以后就可以在jupyter中画图了，下面给出了一个jupyter使用的例子。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy
x <span class="token operator">=</span> numpy<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> x<span class="token operator">**</span><span class="token number">2</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行结果如下图：<br><img src="https://img-blog.csdnimg.cn/20200427203507236.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTYzNjcwMg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="四、Python工作环境管理"><a href="#四、Python工作环境管理" class="headerlink" title="四、Python工作环境管理"></a>四、Python工作环境管理</h3><p>Python 2和Python 3之间存在着较大的差异，并且，由于各种原因导致了Python 2和Python 3的长期 共存。在实际工作过程中，我们可能会同时用到Python 2和Python 3，因此，需要经常在Python 2和 Python 3之间进行来回切换。此外，如果你是喜欢尝鲜的人，那么，你很有可能在Python新版本出来 的时候立即下载Python的版本，试验Python的特性。</p>
<p>在Python世界里，除了需要对Python的版本进行管理以外，还需要对不同的软件包进行管理。大部分 情况下，对于开源的库我们使用***版本即可。但是，有时候可能需要对相同的Python版本，在不同的 项目中使用不同版本的软件包。</p>
<p>在这一节里，我们将介绍两个工具，即pyenv和virtualenv。前者用于管理不同的Python版本，后者用 于管理不同的工作环境。有了这两个工具，Python相关的版本问题将不再是问题。</p>
<h4 id="4-1、使用pyenv管理不同的Python版本"><a href="#4-1、使用pyenv管理不同的Python版本" class="headerlink" title="4.1、使用pyenv管理不同的Python版本"></a>4.1、使用pyenv管理不同的Python版本</h4><p>安装不同的Python版本并不是一件容易的事情，在不同的Python版本之间来回切换更加困难，而且， 多版本并存非常容易互相干扰。因此，我们需要一个名为pyenv的工具。pyenv是一个Python版本管理 工具，它能够进行全局的Python版本切换，也可以为单个项目提供对应的Python版本。使用pyenv以 后，可以在服务器上安装多个不同的Python版本，也可以安装不同的Python实现。不同Python版本之 间的切换也非常简单。接下来我们就一起看一下pyenv的安装和使用。</p>
<h5 id="1、-pyenv的安装"><a href="#1、-pyenv的安装" class="headerlink" title="1、.pyenv的安装"></a>1、.pyenv的安装</h5><p>我们直接从GitHub下载项目到本地，然后，分别执行以下命令进行安装即可</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost .pip<span class="token punctuation">]</span><span class="token comment"># yum -y install git</span>
<span class="token punctuation">[</span>root@localhost .pip<span class="token punctuation">]</span><span class="token comment"># git clone https://github.com/yyuu/pyenv.git ～/.pyenv</span>

正克隆到 <span class="token string">'～/.pyenv'</span><span class="token punctuation">..</span>.
remote: Enumerating objects: <span class="token number">8</span>, done.
remote: Counting objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">8</span>/8<span class="token punctuation">)</span>, done.
remote: Compressing objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">8</span>/8<span class="token punctuation">)</span>, done.
remote: Total <span class="token number">17600</span> <span class="token punctuation">(</span>delta <span class="token number">2</span><span class="token punctuation">)</span>, reused <span class="token number">2</span> <span class="token punctuation">(</span>delta <span class="token number">0</span><span class="token punctuation">)</span>, pack-reused <span class="token number">17592</span>
接收对象中: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">17600</span>/17600<span class="token punctuation">)</span>, <span class="token number">3.44</span> MiB <span class="token operator">|</span> <span class="token number">601.00</span> KiB/s, done.
处理 delta 中: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">11954</span>/11954<span class="token punctuation">)</span>, done.

<span class="token punctuation">[</span>root@localhost .pip<span class="token punctuation">]</span><span class="token comment"># echo 'export PYENV_ROOT="$HOME/.pyenv"' >></span>
～/.bash_profile
<span class="token punctuation">[</span>root@localhost .pip<span class="token punctuation">]</span><span class="token comment"># echo 'export PATH="$PYENV_ROOT/bin:$PATH"' >></span>
～/.bash_profile
<span class="token punctuation">[</span>root@localhost .pip<span class="token punctuation">]</span><span class="token comment"># echo 'eval "$(pyenv init -)"' >>～/.bash_profile</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>安装完成以后需要重新载入配置文件，或者退出以后重新登录，以使～&#x2F;.bash_profile中的配置生效。 笔者一般选择使用source命令重新载入配置文件，如下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost .pip<span class="token punctuation">]</span><span class="token comment"># source ~/.bash_profile</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>至此，pyenv就安装完成了，我们可以通过下面的命令验证pyenv是否正确安装并获取pyenv的帮助信 息：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv --help</span>
Usage: pyenv <span class="token operator">&lt;</span>command<span class="token operator">></span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>args<span class="token operator">></span><span class="token punctuation">]</span>

Some useful pyenv commands are:
	commands 	List all available pyenv commands
	commands 	List all available pyenv commands
	<span class="token builtin class-name">exec</span> 	Run an executable with the selected Python version
	global 	Set or show the global Python version
	<span class="token builtin class-name">help</span> 	Display <span class="token builtin class-name">help</span> <span class="token keyword">for</span> a <span class="token builtin class-name">command</span>
	hooks 	List hook scripts <span class="token keyword">for</span> a given pyenv <span class="token builtin class-name">command</span>
	init 	Configure the shell environment <span class="token keyword">for</span> pyenv
	<span class="token function">install</span> 	Install a Python version using python-build
	<span class="token builtin class-name">local</span> 	Set or show the <span class="token builtin class-name">local</span> application-specific Python version
	prefix 	Display prefix <span class="token keyword">for</span> a Python version
	rehash 	Rehash pyenv shims <span class="token punctuation">(</span>run this after installing executables<span class="token punctuation">)</span>
	root 	Display the root directory where versions and shims are kept
	shell 	Set or show the shell-specific Python version
	shims 	List existing pyenv shims
	uninstall 	Uninstall a specific Python version
	version 	Show the current Python version and its origin
	--version 	Display the version of pyenv
	version-file 	Detect the <span class="token function">file</span> that sets the current pyenv version
	version-name 	Show the current Python version
	version-origin 	Explain how the current Python version is <span class="token builtin class-name">set</span>
	versions 	List all Python versions available to pyenv
	whence 	List all Python versions that contain the given executable
	<span class="token function">which</span> 	Display the full path to an executable

See `pyenv <span class="token builtin class-name">help</span> <span class="token operator">&lt;</span>command<span class="token operator">></span>' <span class="token keyword">for</span> information on a specific command.
For full documentation, see: https://github.com/pyenv/pyenv<span class="token comment">#readme</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="2、pyenv的使用"><a href="#2、pyenv的使用" class="headerlink" title="2、pyenv的使用"></a>2、pyenv的使用</h5><p>我们通过pyenv的install命令，可以查看pyenv当前支持哪些Python版本，如下所示</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv install --list</span>
Available versions:
<span class="token number">2.1</span>.3
……省略部分信息
<span class="token number">3.8</span>.0
<span class="token number">3.8</span>-dev
<span class="token number">3.8</span>.1
<span class="token number">3.9</span>-dev
……省略部分信息
anaconda3-2018.12
anaconda3-2019.03
anaconda3-2019.07
anaconda3-2019.10
……省略部分信息<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>由于pyenv可以安装的Python版本列表非常长，所以，这里进行了省略。读者可以在自己电脑上安装 pyenv，然后执行pyenv install –list命令进行查看。可以看到，pyenv不但可以安装不同的Python版 本，而且还可以安装不同的Python实现，也可以安装***版本的Python用以学习。</p>
<p>查看当前系统中包含的Python版本：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv versions</span>
* system <span class="token punctuation">(</span>set by /root/.pyenv/version<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>使用pyenv安装不同的Python版本：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">pyenv <span class="token function">install</span> -v <span class="token number">3.6</span>.0
pyenv <span class="token function">install</span> -v <span class="token number">2.7</span>.13<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>再次查看当前系统中包含的Python版本：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv versions</span>
* system <span class="token punctuation">(</span>set by /root/.pyenv/version<span class="token punctuation">)</span>
<span class="token number">2.7</span>.13
<span class="token number">3.8</span>.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>由于我们安装了2个Python版本，加上我们系统自身的Python，当前系统中存在3个不同的Python版 本。其中，输出结果前面的“*”表示当前正在使用的版本。我们也可以通过pyenv global选择不同的 Python版本，如下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv global 3.8.1</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv versions</span>
system
<span class="token number">2.7</span>.13
* <span class="token number">3.8</span>.1 <span class="token punctuation">(</span>set by /root/.pyenv/version<span class="token punctuation">)</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># python</span>
Python <span class="token number">3.8</span>.1 <span class="token punctuation">(</span>default, Jan <span class="token number">14</span> <span class="token number">2020</span>, <span class="token number">12</span>:20:36<span class="token punctuation">)</span>
<span class="token punctuation">[</span>GCC <span class="token number">4.8</span>.5 <span class="token number">20150623</span> <span class="token punctuation">(</span>Red Hat <span class="token number">4.8</span>.5-39<span class="token punctuation">)</span><span class="token punctuation">]</span> on linux
Type <span class="token string">"help"</span>, <span class="token string">"copyright"</span>, <span class="token string">"credits"</span> or <span class="token string">"license"</span> <span class="token keyword">for</span> <span class="token function">more</span> information.
<span class="token operator">>></span><span class="token operator">></span> exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv global 2.7.13</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># python</span>
Python <span class="token number">2.7</span>.13 <span class="token punctuation">(</span>default, Jan <span class="token number">14</span> <span class="token number">2020</span>, <span class="token number">12</span>:27:38<span class="token punctuation">)</span>
<span class="token punctuation">[</span>GCC <span class="token number">4.8</span>.5 <span class="token number">20150623</span> <span class="token punctuation">(</span>Red Hat <span class="token number">4.8</span>.5-39<span class="token punctuation">)</span><span class="token punctuation">]</span> on linux2
Type <span class="token string">"help"</span>, <span class="token string">"copyright"</span>, <span class="token string">"credits"</span> or <span class="token string">"license"</span> <span class="token keyword">for</span> <span class="token function">more</span> information.
<span class="token operator">>></span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>使用pyenv以后，可以快速切换Python的版本。切换Python版本以后，与版本相关的依赖也会一起切 换。因此，我们不用担心不同的版本在系统中是否会相互干扰。例如，切换Python版本以后，相应的 pip也会跟着切换，所以不用担心自己使用的pip版本和Python版本不匹配的问题，如下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv global 3.8.1</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pip --version</span>
pip <span class="token number">19.2</span>.3 from /root/.pyenv/versions/3.8.1/lib/python3.8/site-packages/pip
<span class="token punctuation">(</span>python <span class="token number">3.8</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果想要删除Python版本，使用uninstall命令即可。如下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">pyenv uninstall <span class="token number">2.7</span>.10<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="4-2、-使用virtualenv管理不同的项目"><a href="#4-2、-使用virtualenv管理不同的项目" class="headerlink" title="4.2、 使用virtualenv管理不同的项目"></a>4.2、 使用virtualenv管理不同的项目</h4><p>virtualenv本身是一个独立的项目，用以隔离不同项目的工作环境。例如，用户lmx希望在项目A中使用 Flask 0.8这个版本，与此同时，又想在项目B中使用Flask 0.9这个版本。如果我们全局安装Flask，必然 无法满足用户的需求。这个时候，我们就可以使用virtualenv。</p>
<p>读者需要注意pyenv和virtualenv的区别。pyenv用以管理不同的Python版本，例如，你的系统工作时 使用Python 2.7.13，学习时使用Python 3.6.0。virtualenv用以隔离项目的工作环境，例如，项目A和 项目B都是使用Python 2.7.13，但是，项目A需要使用Flask 0.8版本，项目B需要使用Flask 0.9版本。我 们只要组合pyenv和virtualenv这两个工具，就能够构造Python和第三方库的任意版本组合，拥有很好 的灵活性，也避免了项目之间的相互干扰。</p>
<p>virtualenv本身是一个独立的工具，用户可以不使用pyenv而单独使用virtualenv。但是，如果你使用了 pyenv，就需要安装pyenv-virtualenv插件，而不是通过virtualenv软件使用virtualenv的功能。</p>
<h5 id="1、pyenv-virtualenv的安装"><a href="#1、pyenv-virtualenv的安装" class="headerlink" title="1、pyenv-virtualenv的安装"></a>1、pyenv-virtualenv的安装</h5><p>安装和使用pyenv-virtualenv插件如下所示：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># git clone https://github.com/yyuu/pyenv-virtualenv.git</span>
<span class="token variable"><span class="token variable">$(</span>pyenv root<span class="token variable">)</span></span>/plugins/pyenv-virtualenv
正克隆到 <span class="token string">'/root/.pyenv/plugins/pyenv-virtualenv'</span><span class="token punctuation">..</span>.
remote: Enumerating objects: <span class="token number">2064</span>, done.
remote: Total <span class="token number">2064</span> <span class="token punctuation">(</span>delta <span class="token number">0</span><span class="token punctuation">)</span>, reused <span class="token number">0</span> <span class="token punctuation">(</span>delta <span class="token number">0</span><span class="token punctuation">)</span>, pack-reused <span class="token number">2064</span>
接收对象中: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">2064</span>/2064<span class="token punctuation">)</span>, <span class="token number">580.31</span> KiB <span class="token operator">|</span> <span class="token number">264.00</span> KiB/s, done.
处理 delta 中: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">1413</span>/1413<span class="token punctuation">)</span>, done.
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># echo 'eval "$(pyenv virtualenv-init -)"'</span>
<span class="token operator">>></span>~/.bash_profile<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>与安装pyenv类似，安装完成以后需要重新载入配置文件，或者退出用户再登录，以使得配置文件生 效：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># source ~/.bash_profile</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv help virtualenv</span>
Usage: pyenv virtualenv <span class="token punctuation">[</span>-f<span class="token operator">|</span>--force<span class="token punctuation">]</span> <span class="token punctuation">[</span>VIRTUALENV_OPTIONS<span class="token punctuation">]</span> <span class="token punctuation">[</span>version<span class="token punctuation">]</span>
<span class="token operator">&lt;</span>virtualenv-name<span class="token operator">></span>
		pyenv virtualenv --version
		pyenv virtualenv --help
     -f/--force 	Install even <span class="token keyword">if</span> the version appears to be installed
already<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="2、pyenv-virtualenv的使用"><a href="#2、pyenv-virtualenv的使用" class="headerlink" title="2、pyenv-virtualenv的使用"></a>2、pyenv-virtualenv的使用</h5><p>有了pyenv-virtualenv以后，我们可以为同一个Python解释器，创建多个不同的工作环境。例如，我们 新建两个工作环境：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv virtualenv 3.8.1 first_project</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv virtualenv 3.8.1 second_project</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>可以使用virtualenvs子命令查看工作环境：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv virtualenvs</span>
	<span class="token number">3.8</span>.1/envs/first_project <span class="token punctuation">(</span>created from /root/.pyenv/versions/3.8.1<span class="token punctuation">)</span>
	<span class="token number">3.8</span>.1/envs/second_project <span class="token punctuation">(</span>created from 	/root/.pyenv/versions/3.8.1<span class="token punctuation">)</span>
	first_project <span class="token punctuation">(</span>created from /root/.pyenv/versions/3.8.1<span class="token punctuation">)</span>
	second_project <span class="token punctuation">(</span>created from /root/.pyenv/versions/3.8.1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>创建完工作环境以后，可以通过activate和deactivate子命令进入或退出一个工作环境。进入工作环境 以后，左边的提示符会显示你当前所在的工作环境，以免因为环境太多导致操作错误。</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv activate first_project</span>
pyenv-virtualenv: prompt changing will be removed from future release.
configure `export <span class="token assign-left variable">PYENV_VIRTUALENV_DISABLE_PROMPT</span><span class="token operator">=</span><span class="token number">1</span>' to simulate the
behavior.
<span class="token punctuation">(</span>first_project<span class="token punctuation">)</span> <span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pip install flask==1.1.1</span>
Looking <span class="token keyword">in</span> indexes: https://pypi.douban.com/simple/
Collecting flask
	Downloading
https://pypi.doubanio.com/packages/9b/93/628509b8d5dc749656a9641f4caf13540e
2cdec85276964ff8f43bbb1d3b/Flask-1.1.1-py2.py3-none-any.whl <span class="token punctuation">(</span>94kB<span class="token punctuation">)</span>
	<span class="token operator">|</span>████████████████████████████████<span class="token operator">|</span> 102kB <span class="token number">4</span>.7MB/s
……省略部分信息
Successfully installed Jinja2-2.10.3 MarkupSafe-1.1.1 Werkzeug-0.16.0
click-7.0 flask-1.1.1 itsdangerous-1.1.0
<span class="token punctuation">(</span>first_project<span class="token punctuation">)</span> <span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv deactivate</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>接下来，我们看一下在不同的工作环境安装不同的Flask版本：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv activate first_project</span>
<span class="token punctuation">(</span>first_project<span class="token punctuation">)</span> <span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pip install flask==1.1.1</span>
<span class="token punctuation">(</span>first_project<span class="token punctuation">)</span> <span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv deactivate</span>

<span class="token punctuation">(</span>second_project<span class="token punctuation">)</span> <span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pip install flask==0.10.1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>如果想要删除虚拟环境，则使用：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">(</span>first_project<span class="token punctuation">)</span> <span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># pyenv virtualenv-delete first_project</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>使用pyenv和python-virtualenv插件，我们就能够自由地在不同的版本之间进行切换，相比管理Python 版本，不但节省了时间，也避免了工作过程中的相互干扰。</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Echo</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://pdxblog.top/post/2d9dfa10.html">https://pdxblog.top/post/2d9dfa10.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Echo</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Python/">
                                    <span class="chip bg-color">Python</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,csdn,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/post/28327f9.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/10.jpg" class="responsive-img" alt="Python数据类型之字典">
                        
                        <span class="card-title">Python数据类型之字典</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2020-04-27
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Python/" class="post-category">
                                    Python
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Python/">
                        <span class="chip bg-color">Python</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/post/c8f562d1.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/15.jpg" class="responsive-img" alt="Python函数">
                        
                        <span class="card-title">Python函数</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-03-25
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Python/" class="post-category">
                                    Python
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Python/">
                        <span class="chip bg-color">Python</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: Echo’s blog<br />'
            + '文章作者: Echo<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2022</span>
            
            <a href="/about" target="_blank">Echo</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2019";
                        var startMonth = "6";
                        var startDate = "28";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/Gilbert2/echo.github.io" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:maisy0316@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>



    <a href="https://blog.csdn.net/weixin_45636702?spm=1000.2115.3001.5343" class="tooltipped" target="_blank" data-tooltip="访问我的CSDN" data-position="top" data-delay="50">
        <i class="fa-brands fa-blogger"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2960824193" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2960824193" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>




    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
